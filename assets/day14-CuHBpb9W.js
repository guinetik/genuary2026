import{G,P as k,n as X,i as F,o as u,B as D,E as I,R as C,p as M,q as L,m as A}from"./gcanvas.es-CMQjSjBY.js";const P=Math.sqrt(2),h={animDuration:.8,staggerDelay:.1,colors:{largeTriangle1:"#2196F3",largeTriangle2:"#E91E63",mediumTriangle:"#9C27B0",smallTriangle1:"#FFEB3B",smallTriangle2:"#4CAF50",square:"#E53935",parallelogram:"#FF9800"},strokeColor:"#FFFFFF",strokeWidth:2,button:{width:140,height:40,spacing:20}},x={LARGE_LEG:1/P,MEDIUM_LEG:.5,SMALL_LEG:1/(2*P),SQUARE_SIDE:1/(2*P),PARA_BASE:.5,PARA_HEIGHT:.25},S=x.LARGE_LEG,b=x.MEDIUM_LEG,w=x.SMALL_LEG,Y=[{name:"Square #1",pieces:[d(0,0,S,225),d(0,0,S,135),d(.5,.5,b,180),d(.25,-.25,w,315),d(0,0,w,45),{x:.25,y:0,rotation:45},{x:-.125,y:.375,rotation:0}]},{name:"Square #2",pieces:[d(0,0,S,45),d(0,0,S,135),d(.5,-.5,b,90),d(0,0,w,315),d(-.25,-.25,w,225),{x:0,y:-.25,rotation:45},{x:.375,y:.125,rotation:90}]}],O=[{name:"Cat",view:{offsetX:-150,offsetY:-50,scale:.7},pieces:[{x:.416,y:.376,rotation:135},{x:.721,y:.641,rotation:180},{x:.132,y:.23,rotation:315},{x:-.167,y:-.375,rotation:135},{x:.167,y:-.375,rotation:315},{x:0,y:-.124,rotation:45},{x:1.332,y:.751,rotation:0}]},{name:"Cat #2",view:{offsetX:-50,offsetY:-75,scale:.6},pieces:[{x:.405,y:.958,rotation:180},{x:.307,y:.486,rotation:135},{x:.021,y:.217,rotation:315},{x:.167,y:-.501,rotation:315},{x:-.167,y:-.501,rotation:135},{x:0,y:-.25,rotation:45},{x:-.037,y:.571,rotation:225,scaleX:-1}]},{name:"Sitting Cat",view:{offsetX:0,offsetY:0,scale:.8},pieces:[{x:.469,y:.292,rotation:45},{x:-.031,y:.124,rotation:225},{x:-.365,y:.292,rotation:270},{x:.887,y:-.292,rotation:315},{x:.552,y:-.292,rotation:135},{x:.719,y:-.041,rotation:45},{x:-.885,y:.282,rotation:225}]}],T={name:"Bear",view:{offsetX:0,offsetY:-20,scale:.95},pieces:[{x:-.736,y:-.076,rotation:315},{x:-.334,y:-.34,rotation:0},{x:-.03,y:-.243,rotation:180},{x:.61,y:-.34,rotation:270},{x:-.736,y:.424,rotation:135},{x:.314,y:-.399,rotation:0},{x:.135,y:.1,rotation:225}]},R={name:"Shark",view:{offsetX:0,offsetY:-75,scale:.8},pieces:[{x:-.501,y:.333,rotation:45},{x:-.026,y:.236,rotation:90},{x:1.083,y:-.167,rotation:270},{x:-.25,y:.584,rotation:225},{x:.182,y:-.117,rotation:180},{x:.388,y:.177,rotation:0},{x:.739,y:0,rotation:135}]},B={name:"Camel",view:{offsetX:-175,offsetY:-50,scale:.75},pieces:[{x:.411,y:.413,rotation:135},{x:.963,y:.396,rotation:90},{x:.845,y:.042,rotation:45},{x:.16,y:-.338,rotation:315},{x:-.006,y:-.504,rotation:225},{x:.492,y:-.089,rotation:45},{x:.117,y:.036,rotation:90}]},H=[{name:"House #1",view:{offsetX:0,offsetY:0,scale:.9},pieces:[{x:.222,y:-.026,rotation:45},{x:-.024,y:.473,rotation:45},{x:-.358,y:.307,rotation:0},{x:.392,y:.39,rotation:315},{x:.227,y:.225,rotation:225},{x:-.206,y:-.287,rotation:0},{x:-.398,y:.016,rotation:0}]},{name:"House #2",view:{offsetX:0,offsetY:105,scale:.9},pieces:[{x:.22,y:-.153,rotation:270},{x:-.252,y:-.153,rotation:180},{x:.16,y:.319,rotation:45},{x:-.076,y:.202,rotation:0},{x:.396,y:.202,rotation:90},{x:-.37,y:.26,rotation:90},{x:.442,y:-.416,rotation:90}]}],N={name:"Horse Rider",view:{offsetX:-50,offsetY:-55,scale:.7},pieces:[{x:.034,y:.617,rotation:0},{x:.647,y:.481,rotation:180},{x:.172,y:.214,rotation:270},{x:1,y:.244,rotation:270},{x:.765,y:.833,rotation:90},{x:.006,y:-.369,rotation:45},{x:-.58,y:.507,rotation:0}]},$={name:"Horse",view:{offsetX:0,offsetY:-105,scale:.65},pieces:[{x:.167,y:.482,rotation:135},{x:-.235,y:.217,rotation:90},{x:-.353,y:-.489,rotation:45},{x:-.707,y:.149,rotation:45},{x:-.117,y:.924,rotation:180},{x:-.176,y:-.195,rotation:0},{x:.678,y:.835,rotation:225,scaleY:-1}]},W={name:"Helicopter",view:{offsetX:-200,offsetY:75,scale:.85},pieces:[{x:.167,y:0,rotation:135},{x:-.167,y:0,rotation:315},{x:-.355,y:-.618,rotation:45},{x:.501,y:.167,rotation:45},{x:.751,y:.083,rotation:225},{x:1.136,y:-.12,rotation:45},{x:.373,y:-.625,rotation:0,scaleX:-1,scaleY:-1}]},z={name:"Airplane",view:{offsetX:0,offsetY:0,scale:.8},pieces:[{x:.481,y:-.216,rotation:180},{x:-.245,y:-.061,rotation:225},{x:.092,y:.439,rotation:90},{x:-.495,y:.189,rotation:45},{x:-.223,y:-.312,rotation:45},{x:-.745,y:.021,rotation:45},{x:.133,y:.147,rotation:180}]},V={name:"Boat",view:{offsetX:0,offsetY:140,scale:.7},pieces:[{x:.157,y:-.166,rotation:135},{x:-.245,y:.006,rotation:180},{x:.157,y:-.832,rotation:270},{x:.24,y:.25,rotation:45},{x:.24,y:.418,rotation:225},{x:.491,y:.083,rotation:45},{x:-.134,y:.459,rotation:0,scaleY:-1}]},U={name:"Goose",view:{offsetX:0,offsetY:-80,scale:.72},pieces:[{x:.403,y:.447,rotation:225},{x:.138,y:.751,rotation:270},{x:-.214,y:.633,rotation:315},{x:-.317,y:-.385,rotation:180},{x:-.367,y:.383,rotation:135},{x:-.2,y:.132,rotation:45},{x:-.074,y:-.244,rotation:90}]},q={name:"Rabbit",view:{offsetX:0,offsetY:-100,scale:.6},pieces:[{x:-.306,y:.483,rotation:315},{x:.094,y:.954,rotation:270},{x:.026,y:.315,rotation:270},{x:.595,y:-.136,rotation:180},{x:.242,y:.599,rotation:90},{x:.11,y:-.018,rotation:45},{x:-.242,y:-.445,rotation:45}]},K={name:"Rocket",view:{offsetX:50,offsetY:0,scale:.6},pieces:[{x:-.054,y:.267,rotation:315},{x:-.222,y:-.233,rotation:135},{x:-.054,y:-.566,rotation:90},{x:-.556,y:.767,rotation:135},{x:-.137,y:-.817,rotation:45},{x:-.389,y:.516,rotation:45},{x:.237,y:.642,rotation:270}]},j={name:"Turtle",view:{offsetX:0,offsetY:-90,scale:.7},pieces:[{x:.167,y:.326,rotation:135},{x:-.166,y:.326,rotation:315},{x:-.539,y:-.11,rotation:45},{x:.36,y:.82,rotation:90},{x:-.36,y:.82,rotation:0},{x:0,y:-.423,rotation:45},{x:.542,y:-.162,rotation:315,scaleY:-1}]},Q={name:"Pyramid",view:{offsetX:0,offsetY:-50,scale:.95},pieces:[{x:.489,y:.373,rotation:45},{x:-.511,y:.373,rotation:45},{x:-.177,y:.206,rotation:90},{x:.073,y:.289,rotation:135},{x:-.011,y:-.293,rotation:45},{x:.239,y:.04,rotation:45},{x:-.136,y:-.084,rotation:0}]},Z={name:"Frog",view:{offsetX:0,offsetY:-100,scale:.75},pieces:[{x:.169,y:.579,rotation:45},{x:-.033,y:.113,rotation:225},{x:-.027,y:-.173,rotation:45},{x:.386,y:-.472,rotation:90},{x:.269,y:-.355,rotation:270},{x:-.379,y:-.413,rotation:180},{x:.044,y:.871,rotation:180}]},J={name:"Seal",view:{offsetX:-100,offsetY:-100,scale:.85},pieces:[{x:.335,y:.286,rotation:180},{x:-.329,y:.38,rotation:225},{x:.924,y:-.303,rotation:45},{x:.688,y:.286,rotation:0},{x:-.711,y:.096,rotation:270},{x:.747,y:-.009,rotation:90},{x:.747,y:.522,rotation:135}]},tt={name:"Crab",view:{offsetX:0,offsetY:0,scale:.8},pieces:[{x:.292,y:.044,rotation:180},{x:-.295,y:.16,rotation:0},{x:.646,y:-.369,rotation:135},{x:-.648,y:-.546,rotation:180},{x:.409,y:.398,rotation:90},{x:0,y:-.25,rotation:90},{x:-.531,y:-.25,rotation:225}]},et={name:"Giraffe",view:{offsetX:0,offsetY:-200,scale:.53},pieces:[{x:.086,y:1.127,rotation:315},{x:-.415,y:1.127,rotation:315},{x:.419,y:-.29,rotation:270},{x:.169,y:-.124,rotation:315},{x:-.164,y:.877,rotation:135},{x:.003,y:.626,rotation:45},{x:.127,y:.252,rotation:270}]},st={name:"Crow",view:{offsetX:-275,offsetY:-125,scale:.8},pieces:[{x:.765,y:.236,rotation:90},{x:.501,y:-.166,rotation:45},{x:1.167,y:.333,rotation:270},{x:.931,y:.804,rotation:45},{x:-.249,y:-.083,rotation:45},{x:0,y:-.25,rotation:45},{x:1.376,y:.625,rotation:180,scaleY:-1}]},v=[...Y,...O,...H,K,q,U,V,N,B,T,R,st,et,tt,j,Q,Z,J,$,W,z],E=Y[0],it={offsetX:0,offsetY:0,scale:1};function ot(g,t,e){const s=e*Math.PI/180;return{x:g*Math.cos(s)-t*Math.sin(s),y:g*Math.sin(s)+t*Math.cos(s)}}function d(g,t,e,s){const i={x:-e/3,y:-e/3},o=ot(i.x,i.y,s);return{x:g-o.x,y:t-o.y,rotation:s}}function nt(g){return g.view??it}function at(g,t=45){return(Math.round(g/t)*t%360+360)%360}class rt extends A{constructor(t,e,s={}){super(t,s),this.shape=e,this.baseSize=s.baseSize||100,this.scaleX=1,this.scaleY=1,this.interactive=!0,this._calculateHitSize(),this._calculateLocalVertices()}_calculateHitSize(){const t=this.shape;t.leg!==void 0?(this.width=t.leg,this.height=t.leg):t.side!==void 0?(this.width=t.side,this.height=t.side):t.width!==void 0?(this.width=t.width+(t.slant||0),this.height=t.height||t.width):(this.width=50,this.height=50)}_calculateLocalVertices(){const t=this.shape;if(t.leg!==void 0){const e=t.leg,s=e/3,i=e/3;this._localVertices=[{x:-s,y:-i},{x:e-s,y:-i},{x:-s,y:e-i}]}else if(t.side!==void 0){const e=t.side/2;this._localVertices=[{x:-e,y:-e},{x:e,y:-e},{x:e,y:e},{x:-e,y:e}]}else if(t.width!==void 0){const e=t.width,s=t.height,i=t.slant||0;this._localVertices=[{x:-e/2,y:s/2},{x:e/2,y:s/2},{x:e/2+i,y:-s/2},{x:-e/2+i,y:-s/2}]}else this._localVertices=[]}getWorldVertices(){const t=this._rotationDeg!==void 0?this._rotationDeg*Math.PI/180:this.rotation,e=Math.cos(t),s=Math.sin(t);return this._localVertices.map(i=>({x:this.x+i.x*e-i.y*s,y:this.y+i.x*s+i.y*e}))}getBounds(){const t=this.width*Math.abs(this.scaleX),e=this.height*Math.abs(this.scaleY);return{x:this.x,y:this.y,width:t,height:e}}animateTo(t,e=0){u.killTarget(this),u.to(this,{x:t.x*this.baseSize,y:t.y*this.baseSize,rotation:t.rotation,scaleX:t.scaleX??1,scaleY:t.scaleY??1},h.animDuration,I.easeOutBack,{delay:e})}setPosition(t){this.x=t.x*this.baseSize,this.y=t.y*this.baseSize,this.rotation=t.rotation,this.scaleX=t.scaleX??1,this.scaleY=t.scaleY??1}draw(){super.draw(),this.shape.draw()}}class ct extends G{constructor(t){super(t),this.configIndex=0,this.draggingPiece=null,this.selectedPiece=null,this._onKeyDown=null,this._onCanvasClick=null,this._dragCleanups=[],this.shuffledIndices=[],this.shufflePosition=0}init(){super.init(),k.init(this.ctx),this.baseSize=Math.min(this.width,this.height)*.8,this.scene=new X(this,{x:this.width/2,y:this.height/2}),this.pieces=this.createPieces();for(const t of this.pieces)this.scene.add(t);this.pipeline.add(this.scene),this.createButtons(),this.initStateMachine(),this.initKeyboardHandler(),this.canvas.tabIndex=0,this.canvas.style.outline="none",this.canvas.addEventListener("pointerdown",()=>this.canvas.focus()),this.canvas.focus()}initStateMachine(){this.fsm=new F({initial:"menu",context:this,states:{menu:{enter:()=>{this.showButtons(!0),this.removeCanvasClickHandler(),this.disableDragging(),this.configuration=v[0],this.applyConfiguration(!1)},exit:()=>{this.showButtons(!1)}},showcase:{enter:()=>{this.shuffleConfigs(),this.configIndex=this.shuffledIndices[0],this.shufflePosition=0,this.configuration=v[this.configIndex],this.applyConfiguration(!1),this.assignDistinctColors(),this.setupCanvasClickHandler(()=>this.toggleShowcase()),this.disableDragging()},exit:()=>{this.removeCanvasClickHandler()}},design:{enter:()=>{for(const t of this.pieces)u.killTarget(t);u.killTarget(this.scene),this.scene.x=this.width/2,this.scene.y=this.height/2,E?(this.loadDesignConfig(E),console.log(`[Design Mode] Loaded config: ${E.name}`)):(this.scene.scaleX=1,this.scene.scaleY=1,this._designScale=1,this.scatterPieces()),this.enableDragging(),this.enableWheelZoom(),console.log("[Design Mode] Q/E rotate, W/S flip, Wheel zoom, Drag canvas, P print, SHIFT = no snap")},exit:()=>{this.disableDragging(),this.disableWheelZoom()}}}})}createButtons(){const{width:t,height:e,spacing:s}=h.button,i=this.width/2,o=this.height/2;this.showcaseBtn=new D(this,{x:i-t/2-s/2,y:o,width:t,height:e,text:"Showcase",onClick:()=>this.fsm.setState("showcase")}),this.designBtn=new D(this,{x:i+t/2+s/2,y:o,width:t,height:e,text:"Design",onClick:()=>this.fsm.setState("design")}),this.backBtn=new D(this,{x:80,y:30,width:100,height:30,text:"← Back",onClick:()=>this.fsm.setState("menu")}),this.pipeline.add(this.showcaseBtn),this.pipeline.add(this.designBtn),this.pipeline.add(this.backBtn)}showButtons(t){this.showcaseBtn&&(this.showcaseBtn.visible=t,this.designBtn.visible=t,this.backBtn.visible=!t,this.showcaseBtn.interactive=t,this.designBtn.interactive=t,this.backBtn.interactive=!t)}initKeyboardHandler(){this._onKeyDown=e=>{const s=e.key.toLowerCase();if(this.fsm.is("design")&&this.selectedPiece){if(s==="q"||s==="e"){e.preventDefault(),e.stopPropagation(),this.selectedPiece._rotationDeg===void 0&&(this.selectedPiece._rotationDeg=0);const i=s==="q"?-45:45;this.selectedPiece._rotationDeg+=i,console.log(`[Rotate] ${s.toUpperCase()}: ${this.selectedPiece._rotationDeg-i}° -> ${this.selectedPiece._rotationDeg}°`),this.selectedPiece.rotation=this.selectedPiece._rotationDeg;return}if(s==="w"||s==="s"){e.preventDefault(),e.stopPropagation(),s==="w"?(this.selectedPiece.scaleX*=-1,console.log(`[Flip] Horizontal: scaleX = ${this.selectedPiece.scaleX}`)):(this.selectedPiece.scaleY*=-1,console.log(`[Flip] Vertical: scaleY = ${this.selectedPiece.scaleY}`));return}}if(s==="p"&&this.fsm.is("design")){e.preventDefault(),e.stopPropagation(),this.printConfiguration();return}s==="escape"&&!this.fsm.is("menu")&&(e.preventDefault(),this.fsm.setState("menu")),e.shiftKey&&(this._shiftHeld=!0)},this._onKeyUp=e=>{e.key==="Shift"&&(this._shiftHeld=!1)},window.addEventListener("keydown",this._onKeyDown,{capture:!0}),window.addEventListener("keyup",this._onKeyUp,{capture:!0})}setupCanvasClickHandler(t){this.removeCanvasClickHandler(),this._onCanvasClick=t,this.canvas.addEventListener("click",this._onCanvasClick)}removeCanvasClickHandler(){this._onCanvasClick&&(this.canvas.removeEventListener("click",this._onCanvasClick),this._onCanvasClick=null)}enableDragging(){this.disableDragging();for(const t of this.pieces){t.interactive=!0,t._dragOffset={x:0,y:0},t._isDragging=!1;const e=o=>{t._isDragging=!0,this.draggingPiece=t,this.selectPiece(t);const n=this.scene.scaleX||1,a=(o.x-this.scene.x)/n,r=(o.y-this.scene.y)/n;t._dragOffset.x=t.x-a,t._dragOffset.y=t.y-r},s=o=>{if(!t._isDragging)return;const n=this.scene.scaleX||1,a=(o.x-this.scene.x)/n,r=(o.y-this.scene.y)/n;t.x=a+t._dragOffset.x,t.y=r+t._dragOffset.y},i=()=>{t._isDragging&&(t._isDragging=!1,this.draggingPiece=null,this.snapPieceToNearby(t))};t.on("inputdown",e),this.events.on("inputmove",s),this.events.on("inputup",i),this._dragCleanups.push(()=>{t.off("inputdown",e),this.events.off("inputmove",s),this.events.off("inputup",i),delete t._dragOffset,delete t._isDragging})}this._clickedPiece=!1,this._isDraggingCanvas=!1,this._canvasDragStart={x:0,y:0},this._sceneDragStart={x:0,y:0},this._onDesignCanvasDown=t=>{this._clickedPiece=!1,setTimeout(()=>{!this._clickedPiece&&!this.draggingPiece&&(this._isDraggingCanvas=!0,this._canvasDragStart.x=t.x,this._canvasDragStart.y=t.y,this._sceneDragStart.x=this.scene.x,this._sceneDragStart.y=this.scene.y)},0)},this._onDesignCanvasMove=t=>{if(this._isDraggingCanvas){const e=t.x-this._canvasDragStart.x,s=t.y-this._canvasDragStart.y;this.scene.x=this._sceneDragStart.x+e,this.scene.y=this._sceneDragStart.y+s}},this._onDesignCanvasUp=()=>{!this._clickedPiece&&!this.draggingPiece&&!this._isDraggingCanvas&&this.deselectPiece(),this._isDraggingCanvas=!1};for(const t of this.pieces){const e=()=>{this._clickedPiece=!0};t.on("inputdown",e),this._dragCleanups.push(()=>t.off("inputdown",e))}this.events.on("inputdown",this._onDesignCanvasDown),this.events.on("inputmove",this._onDesignCanvasMove),this.events.on("inputup",this._onDesignCanvasUp),this._dragCleanups.push(()=>{this.events.off("inputdown",this._onDesignCanvasDown),this.events.off("inputmove",this._onDesignCanvasMove),this.events.off("inputup",this._onDesignCanvasUp)})}selectPiece(t){this.selectedPiece&&this.selectedPiece!==t&&this.restorePieceStroke(this.selectedPiece),this.selectedPiece=t,this.scene.bringToFront(t),t._originalStroke||(t._originalStroke=t.shape.stroke,t._originalLineWidth=t.shape.lineWidth),t.shape.stroke="#0f0",t.shape.lineWidth=4}restorePieceStroke(t){t._originalStroke!==void 0&&(t.shape.stroke=t._originalStroke,t.shape.lineWidth=t._originalLineWidth)}deselectPiece(){this.selectedPiece&&(this.restorePieceStroke(this.selectedPiece),this.selectedPiece=null)}disableDragging(){for(const t of this._dragCleanups)typeof t=="function"&&t();this._dragCleanups=[],this.draggingPiece=null,this.deselectPiece()}enableWheelZoom(){this._onWheel=t=>{t.preventDefault();const e=.05,s=t.deltaY>0?-e:e;this._designScale=Math.max(.3,Math.min(1,this._designScale+s)),this.scene.scaleX=this._designScale,this.scene.scaleY=this._designScale},this.canvas.addEventListener("wheel",this._onWheel,{passive:!1})}disableWheelZoom(){this._onWheel&&(this.canvas.removeEventListener("wheel",this._onWheel),this._onWheel=null)}_closestPointOnSegment(t,e,s){const i=s.x-e.x,o=s.y-e.y,n=t.x-e.x,a=t.y-e.y,r=i*i+o*o;if(r===0){const f=Math.sqrt(n*n+a*a);return{x:e.x,y:e.y,dist:f}}let c=(n*i+a*o)/r;c=Math.max(0,Math.min(1,c));const p=e.x+c*i,y=e.y+c*o,l=t.x-p,_=t.y-y,m=Math.sqrt(l*l+_*_);return{x:p,y,dist:m,t:c}}snapPieceToNearby(t){if(this._shiftHeld){console.log("[Snap] Disabled (SHIFT held)");return}const e=20,s=15,i=t.getWorldVertices();if(i.length===0)return;let o=null,n=Math.max(e,s),a="";for(const r of this.pieces){if(r===t)continue;const c=r.getWorldVertices(),p=c.length;for(const y of i)for(const l of c){const _=l.x-y.x,m=l.y-y.y,f=Math.sqrt(_*_+m*m);f<n&&f<e&&(n=f,o={dx:_,dy:m},a="vertex")}if(n>s*.5)for(const y of i)for(let l=0;l<p;l++){const _=c[l],m=c[(l+1)%p],f=this._closestPointOnSegment(y,_,m);f.t<.05||f.t>.95||f.dist<n&&f.dist<s&&(n=f.dist,o={dx:f.x-y.x,dy:f.y-y.y},a="edge")}}o&&(t.x+=o.dx,t.y+=o.dy,console.log(`[Snap] ${a} snap by (${o.dx.toFixed(1)}, ${o.dy.toFixed(1)})`))}scatterPieces(){const t=this.baseSize*.25,e=4,s=-t*1.5,i=-t;for(let o=0;o<this.pieces.length;o++){const n=this.pieces[o],a=o%e,r=Math.floor(o/e);n.x=s+a*t,n.y=i+r*t,n.rotation=0,n._rotationDeg=0,n.scaleX=n.scaleY=1}}loadDesignConfig(t){const e=t.view??{scale:1};this._designScale=e.scale,this.scene.scaleX=e.scale,this.scene.scaleY=e.scale;for(let s=0;s<this.pieces.length;s++){const i=this.pieces[s],o=t.pieces[s];i.x=o.x*this.baseSize,i.y=o.y*this.baseSize,i.rotation=o.rotation,i._rotationDeg=o.rotation,i.scaleX=o.scaleX??1,i.scaleY=o.scaleY??1}}printConfiguration(){const t=["Large 1","Large 2","Medium","Small 1","Small 2","Square","Parallelogram"];console.log(`
=== TANGRAM CONFIGURATION ===`),console.log(`Copy this into ALL_CONFIGS:
`);const s=`{
  name: "custom",
  view: { offsetX: 0, offsetY: 0, scale: ${(this._designScale??1).toFixed(2)} },
  pieces: [
${this.pieces.map((i,o)=>{const n=(i.x/this.baseSize).toFixed(3),a=(i.y/this.baseSize).toFixed(3),r=i._rotationDeg!==void 0?i._rotationDeg:i.rotation*180/Math.PI,c=at(r,45),p=i.scaleX??1,y=i.scaleY??1;let l="";return p!==1&&(l+=`, scaleX: ${p}`),y!==1&&(l+=`, scaleY: ${y}`),`    // ${t[o]}
    { x: ${n}, y: ${a}, rotation: ${c}${l} },`}).join(`
`)}
  ],
}`;console.log(s),console.log(`
=============================
`)}applySceneView(t=!0){const e=nt(this.configuration),i=this.baseSize/640,o={x:this.width/2+e.offsetX*i,y:this.height/2+e.offsetY*i,scaleX:e.scale,scaleY:e.scale};u.killTarget(this.scene),t?u.to(this.scene,o,h.animDuration,I.easeOutBack):(this.scene.x=o.x,this.scene.y=o.y,this.scene.scaleX=o.scaleX,this.scene.scaleY=o.scaleY)}toggleShowcase(){this.nextConfiguration(),this.assignDistinctColors()}assignDistinctColors(){const t=this.pieces.length,e=30,s=[];let i=Math.random()*360;for(let o=0;o<t;o++)s.push(i%360),i+=e+Math.random()*40;for(let o=s.length-1;o>0;o--){const n=Math.floor(Math.random()*(o+1));[s[o],s[n]]=[s[n],s[o]]}for(let o=0;o<t;o++){const n=Math.round(s[o]),a=70+Math.random()*25,r=45+Math.random()*20,c=`hsl(${n}, ${a.toFixed(0)}%, ${r.toFixed(0)}%)`;this.pieces[o].shape.color=c,this.pieces[o].shape.fill=c}}scatterPiecesAnimated(){const t={offsetX:0,offsetY:0,scale:1};this.configuration={view:t},this.applySceneView(!0);for(let e=0;e<this.pieces.length;e++){const s=this.pieces[e];u.killTarget(s),s._originalColor||(s._originalColor=s.shape.color);const i=(Math.random()-.5)*this.baseSize*1.2,o=(Math.random()-.5)*this.baseSize*1.2,n=Math.floor(Math.random()*8)*45,a=k.colors.randomColorHSL();s.shape.color=a,s.shape.fill=a,u.to(s,{x:i,y:o,rotation:n},h.animDuration,I.easeOutBack,{delay:e*h.staggerDelay})}}restoreOriginalColors(){for(const t of this.pieces)t._originalColor&&(t.shape.color=t._originalColor,t.shape.fill=t._originalColor)}createPieces(){const t=this.baseSize,e=[],s=o=>new rt(this,o,{baseSize:t}),i=o=>({color:o,stroke:h.strokeColor,lineWidth:h.strokeWidth,lineJoin:"round"});return e.push(s(new C(x.LARGE_LEG*t,i(h.colors.largeTriangle1)))),e.push(s(new C(x.LARGE_LEG*t,i(h.colors.largeTriangle2)))),e.push(s(new C(x.MEDIUM_LEG*t,i(h.colors.mediumTriangle)))),e.push(s(new C(x.SMALL_LEG*t,i(h.colors.smallTriangle1)))),e.push(s(new C(x.SMALL_LEG*t,i(h.colors.smallTriangle2)))),e.push(s(new M(x.SQUARE_SIDE*t,i(h.colors.square)))),e.push(s(new L({width:x.PARA_BASE*t,height:x.PARA_HEIGHT*t,slant:x.PARA_HEIGHT*t,...i(h.colors.parallelogram)}))),e}applyConfiguration(t=!0){const e=this.configuration;for(let s=0;s<this.pieces.length;s++){const i=e.pieces[s];t?this.pieces[s].animateTo(i,s*h.staggerDelay):this.pieces[s].setPosition(i)}this.applySceneView(t)}shuffleConfigs(){const t=v.length;this.shuffledIndices=Array.from({length:t},(e,s)=>s);for(let e=t-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[this.shuffledIndices[e],this.shuffledIndices[s]]=[this.shuffledIndices[s],this.shuffledIndices[e]]}console.log(`[Showcase] Shuffled ${t} configs: ${this.shuffledIndices.map(e=>v[e].name).join(", ")}`)}nextConfiguration(){const t=v.length;t!==0&&(this.shufflePosition++,this.shufflePosition>=t&&(this.shuffleConfigs(),this.shufflePosition=0),this.configIndex=this.shuffledIndices[this.shufflePosition],this.configuration=v[this.configIndex],console.log(`Assembling: ${this.configuration.name} (${this.shufflePosition+1}/${t})`),this.applyConfiguration(!0))}update(t){super.update(t),u.updateAll(t),this.fsm.update(t)}render(){var t,e;if(super.render(),((t=this.fsm)==null?void 0:t.state)==="showcase"&&((e=this.configuration)!=null&&e.name)){const s=this.ctx,i=this.configuration.name;s.save(),s.font='14px "Fira Code", monospace',s.fillStyle="rgba(255, 255, 255, 0.5)",s.textAlign="left",s.textBaseline="bottom",s.fillText(i,16,this.height-16),s.restore()}}stop(){this._onKeyDown&&window.removeEventListener("keydown",this._onKeyDown,{capture:!0}),this._onKeyUp&&window.removeEventListener("keyup",this._onKeyUp,{capture:!0}),this.removeCanvasClickHandler(),this.disableDragging(),super.stop()}}function lt(g){const t=new ct(g);return t.start(),{stop:()=>t.stop(),game:t}}export{lt as default};
