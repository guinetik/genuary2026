import{G as S}from"./gcanvas.es-CMQjSjBY.js";const i={cellSize:4,stepsPerFrame:50,baseHue:120,hueSpeed:8,trailLength:60,particlesPerFlip:2,particleLife:.8,particleSpeed:40},g=[0,1,0,-1],u=[-1,0,1,0];class z extends S{constructor(t){super(t),this.backgroundColor="#000"}init(){super.init(),this.cols=Math.floor(this.width/i.cellSize),this.rows=Math.floor(this.height/i.cellSize),this.grid=new Array(this.cols*this.rows).fill(!1),this.antX=Math.floor(this.cols/2),this.antY=Math.floor(this.rows/2),this.antDir=0,this.stepCount=0,this.time=0,this.hue=i.baseHue,this.trail=[],this.particles=[],this.gridCanvas=document.createElement("canvas"),this.gridCanvas.width=this.cols*i.cellSize,this.gridCanvas.height=this.rows*i.cellSize,this.gridCtx=this.gridCanvas.getContext("2d"),this.gridCtx.fillStyle=`hsl(${this.hue}, 80%, 5%)`,this.gridCtx.fillRect(0,0,this.gridCanvas.width,this.gridCanvas.height)}step(){const t=this.antY*this.cols+this.antX,s=this.grid[t];this.trail.push({x:this.antX,y:this.antY,hue:this.hue}),this.trail.length>i.trailLength&&this.trail.shift(),s?this.antDir=(this.antDir+3)%4:this.antDir=(this.antDir+1)%4,this.grid[t]=!s;const e=this.grid[t]?45:8;this.gridCtx.fillStyle=`hsl(${this.hue}, 100%, ${e}%)`,this.gridCtx.fillRect(this.antX*i.cellSize,this.antY*i.cellSize,i.cellSize,i.cellSize);const r=this.antX*i.cellSize+i.cellSize/2,n=this.antY*i.cellSize+i.cellSize/2;for(let h=0;h<i.particlesPerFlip;h++){const a=Math.random()*Math.PI*2;this.particles.push({x:r,y:n,vx:Math.cos(a)*i.particleSpeed*(.5+Math.random()),vy:Math.sin(a)*i.particleSpeed*(.5+Math.random()),life:i.particleLife,maxLife:i.particleLife,hue:this.hue})}this.antX+=g[this.antDir],this.antY+=u[this.antDir],this.antX<0&&(this.antX=this.cols-1),this.antX>=this.cols&&(this.antX=0),this.antY<0&&(this.antY=this.rows-1),this.antY>=this.rows&&(this.antY=0),this.stepCount++}update(t){super.update(t),this.time+=t,this.hue=(i.baseHue+this.time*i.hueSpeed)%360;for(let s=0;s<i.stepsPerFrame;s++)this.step();for(let s=this.particles.length-1;s>=0;s--){const e=this.particles[s];e.x+=e.vx*t,e.y+=e.vy*t,e.vx*=.95,e.vy*=.95,e.life-=t,e.life<=0&&this.particles.splice(s,1)}this.particles.length>500&&(this.particles=this.particles.slice(-400))}render(){const t=this.ctx,s=this.width,e=this.height;t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(0,0,s,e);const r=(s-this.gridCanvas.width)/2,n=(e-this.gridCanvas.height)/2;t.drawImage(this.gridCanvas,r,n);for(let l=0;l<this.trail.length;l++){const c=this.trail[l],f=l/this.trail.length*.6,d=i.cellSize*.4*(l/this.trail.length);t.fillStyle=`hsla(${c.hue}, 100%, 60%, ${f})`,t.beginPath(),t.arc(r+c.x*i.cellSize+i.cellSize/2,n+c.y*i.cellSize+i.cellSize/2,d,0,Math.PI*2),t.fill()}for(const l of this.particles){const c=l.life/l.maxLife*.8,f=2*(l.life/l.maxLife);t.fillStyle=`hsla(${l.hue}, 100%, 70%, ${c})`,t.beginPath(),t.arc(r+l.x,n+l.y,f,0,Math.PI*2),t.fill()}const h=r+this.antX*i.cellSize+i.cellSize/2,a=n+this.antY*i.cellSize+i.cellSize/2;t.shadowBlur=15,t.shadowColor=`hsl(${this.hue}, 100%, 60%)`;const o=t.createRadialGradient(h,a,0,h,a,i.cellSize*4);o.addColorStop(0,`hsla(${this.hue}, 100%, 90%, 1)`),o.addColorStop(.2,`hsla(${this.hue}, 100%, 60%, 0.6)`),o.addColorStop(1,`hsla(${this.hue}, 100%, 50%, 0)`),t.fillStyle=o,t.beginPath(),t.arc(h,a,i.cellSize*4,0,Math.PI*2),t.fill(),t.fillStyle="#fff",t.beginPath(),t.arc(h,a,i.cellSize*.8,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.font='14px "Fira Code", monospace',t.fillStyle=`hsla(${this.hue}, 100%, 70%, 0.8)`,t.textAlign="left",t.fillText("LANGTON'S ANT",20,30),t.fillStyle=`hsla(${this.hue}, 100%, 60%, 0.6)`,t.fillText(`Steps: ${this.stepCount.toLocaleString()}`,20,50)}}function C(p){const t=new z(p);return t.start(),{stop:()=>t.stop(),game:t}}export{C as default};
