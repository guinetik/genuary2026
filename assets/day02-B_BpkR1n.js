import{G as x}from"./gcanvas.es-ChtmA8T6.js";const h={segmentCount:40,segmentSpacing:12,baseRadius:8,radiusFalloff:.85,followSpeed:.15,velocityStretch:.4,maxStretch:2.5,hueStart:280,hueEnd:180,trailAlpha:.08};class y{constructor(t,a,i,e){this.x=t,this.y=a,this.targetX=t,this.targetY=a,this.vx=0,this.vy=0,this.radius=i,this.index=e,this.angle=0}follow(t,a,i){const e=this.x,s=this.y;this.x+=(t-this.x)*i,this.y+=(a-this.y)*i,this.vx=this.x-e,this.vy=this.y-s;const n=t-this.x,o=a-this.y;(Math.abs(n)>.01||Math.abs(o)>.01)&&(this.angle=Math.atan2(o,n))}getSpeed(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)}}class w extends x{constructor(t){super(t),this.backgroundColor="#000"}init(){super.init();const t=this.width/2,a=this.height/2;this.segments=[];let i=h.baseRadius;for(let e=0;e<h.segmentCount;e++)this.segments.push(new y(t,a,i,e)),i*=h.radiusFalloff;this.targetX=t,this.targetY=a,this.canvas.addEventListener("mousemove",e=>{const s=this.canvas.getBoundingClientRect();this.targetX=(e.clientX-s.left)*(this.width/s.width),this.targetY=(e.clientY-s.top)*(this.height/s.height)}),this.canvas.addEventListener("touchmove",e=>{e.preventDefault();const s=this.canvas.getBoundingClientRect(),n=e.touches[0];this.targetX=(n.clientX-s.left)*(this.width/s.width),this.targetY=(n.clientY-s.top)*(this.height/s.height)},{passive:!1}),this.time=0}update(t){super.update(t),this.time+=t,this.segments[0].follow(this.targetX,this.targetY,h.followSpeed*2);for(let i=1;i<this.segments.length;i++){const e=this.segments[i],s=this.segments[i-1],n=h.segmentSpacing,o=s.x-Math.cos(s.angle)*n,l=s.y-Math.sin(s.angle)*n,c=h.followSpeed*(1-i*.01);e.follow(o,l,Math.max(.05,c))}}render(){const t=this.ctx,a=this.width,i=this.height;t.fillStyle=`rgba(0, 0, 0, ${h.trailAlpha})`,t.fillRect(0,0,a,i);for(let e=this.segments.length-1;e>=0;e--){const s=this.segments[e],n=e/(this.segments.length-1),o=s.getSpeed(),l=Math.min(h.maxStretch,1+o*h.velocityStretch),c=1/Math.sqrt(l),f=1+Math.sin(this.time*3+e*.3)*.1,S=s.radius*l*f,v=s.radius*c*f,r=h.hueStart+(h.hueEnd-h.hueStart)*n,g=60-n*20,m=1-n*.3;t.save(),t.translate(s.x,s.y),t.rotate(s.angle);const p=S*2,d=t.createRadialGradient(0,0,0,0,0,p);d.addColorStop(0,`hsla(${r}, 100%, ${g}%, ${m})`),d.addColorStop(.5,`hsla(${r}, 100%, ${g}%, ${m*.5})`),d.addColorStop(1,`hsla(${r}, 100%, ${g}%, 0)`),t.beginPath(),t.ellipse(0,0,p,p*c/l,0,0,Math.PI*2),t.fillStyle=d,t.fill(),t.beginPath(),t.ellipse(0,0,S,v,0,0,Math.PI*2),t.fillStyle=`hsla(${r}, 100%, ${g+20}%, ${m})`,t.fill(),t.restore()}t.beginPath(),t.moveTo(this.segments[0].x,this.segments[0].y);for(let e=1;e<this.segments.length;e++){const s=this.segments[e];t.lineTo(s.x,s.y)}t.strokeStyle=`hsla(${h.hueStart}, 80%, 50%, 0.2)`,t.lineWidth=2,t.stroke()}}function M(u){const t=new w(u);return t.start(),{stop:()=>t.stop(),game:t}}export{M as default};
