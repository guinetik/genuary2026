import{G as M,P as v}from"./gcanvas.es-C8KsZzA1.js";const i={goldenAngle:137.5077640500378,numSeeds:1e3,baseRadiusRatio:.015,spacingRatio:.012,pulseSpeed:1.5,rotationSpeed:.15,waveSpeed:2,waveAmplitudeRatio:.03,hueSpeed:30,saturation:85,mouseRadiusRatio:.25,mouseForceRatio:.15,explosionForceRatio:.5,explosionDecay:.96,centerSizeRatio:.04},p=Math.PI*2,R=i.goldenAngle*Math.PI/180;class S extends M{constructor(t){super(t),this.backgroundColor="#000"}init(){super.init(),v.init(this.ctx),this.time=0,this.hueOffset=0,this.globalRotation=0,this.mouseX=0,this.mouseY=0,this.exploding=!1,this.explosionTime=0,this.seeds=[];for(let t=0;t<i.numSeeds;t++){const e=t*R,n=Math.sqrt(t);this.seeds.push({index:t,baseAngle:e,radiusFactor:n,angle:e,radius:0,vx:0,vy:0,sizeFactor:Math.max(.3,1-t*5e-4),phase:Math.random()*p})}this.canvas.addEventListener("mousemove",t=>{const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left-this.width/2,this.mouseY=t.clientY-e.top-this.height/2}),this.canvas.addEventListener("click",()=>{this.explode()}),this.canvas.addEventListener("mouseleave",()=>{this.mouseX=0,this.mouseY=0})}explode(){this.exploding=!0,this.explosionTime=this.time;const t=Math.min(this.width,this.height),e=t*i.explosionForceRatio,n=t*i.spacingRatio;for(const o of this.seeds){const a=o.radiusFactor*n,h=Math.cos(o.angle)*a,s=Math.sin(o.angle)*a,l=Math.sqrt(h*h+s*s)+1,r=e/Math.sqrt(l+50),d=t*.06;o.vx=h/l*r+(Math.random()-.5)*d,o.vy=s/l*r+(Math.random()-.5)*d}}update(t){super.update(t),this.time+=t,this.hueOffset+=i.hueSpeed*t,this.globalRotation+=i.rotationSpeed*t;const e=Math.min(this.width,this.height),n=e*i.spacingRatio,o=e*i.waveAmplitudeRatio,a=e*i.mouseRadiusRatio,h=e*i.mouseForceRatio;for(const s of this.seeds){const l=s.radiusFactor*n;let r=Math.cos(s.angle)*s.radius,d=Math.sin(s.angle)*s.radius;if(this.exploding){r+=s.vx*t,d+=s.vy*t,s.vx*=i.explosionDecay,s.vy*=i.explosionDecay;const u=Math.cos(s.baseAngle+this.globalRotation)*l,g=Math.sin(s.baseAngle+this.globalRotation)*l,m=u-r,c=g-d;s.vx+=m*2*t,s.vy+=c*2*t,s.angle=Math.atan2(d+s.vy*t,r+s.vx*t),s.radius=Math.sqrt((r+s.vx*t)**2+(d+s.vy*t)**2),this.time-this.explosionTime>3&&(this.exploding=!1)}else{s.angle=s.baseAngle+this.globalRotation;const u=Math.sin(this.time*i.pulseSpeed+s.index*.02)*.1+1,g=Math.sin(this.time*i.waveSpeed-l*.05)*o;s.radius=l*u+g*(l/(e*.25));const m=Math.sqrt((r-this.mouseX)**2+(d-this.mouseY)**2);if(m<a){const c=(a-m)/a;s.radius+=c*h*(1-s.index/i.numSeeds),s.angle+=c*.3*Math.sin(this.time*5)}}}}render(){const t=this.ctx,e=this.width,n=this.height,o=e/2,a=n/2;t.fillStyle="rgba(0, 0, 0, 0.15)",t.fillRect(0,0,e,n),this.drawConnections(t,o,a),this.drawSeeds(t,o,a),this.drawCenter(t,o,a)}drawConnections(t,e,n){t.strokeStyle=`hsla(${this.hueOffset%360}, 70%, 50%, 0.05)`,t.lineWidth=.5,t.beginPath();for(let o=1;o<Math.min(500,this.seeds.length);o++){const a=this.seeds[o],h=this.seeds[o-1],s=e+Math.cos(h.angle)*h.radius,l=n+Math.sin(h.angle)*h.radius,r=e+Math.cos(a.angle)*a.radius,d=n+Math.sin(a.angle)*a.radius;t.moveTo(s,l),t.lineTo(r,d)}t.stroke()}drawSeeds(t,e,n){const a=Math.min(this.width,this.height)*i.baseRadiusRatio;for(let h=this.seeds.length-1;h>=0;h--){const s=this.seeds[h],l=e+Math.cos(s.angle)*s.radius,r=n+Math.sin(s.angle)*s.radius,d=(s.index*.5+this.hueOffset)%360,u=50+Math.sin(this.time*3+s.phase)*15,g=Math.sin(this.time*4+s.index*.1)*.3+1,m=a*s.sizeFactor*g;t.globalCompositeOperation="lighter";const c=t.createRadialGradient(l,r,0,l,r,m*2);c.addColorStop(0,`hsla(${d}, ${i.saturation}%, ${u}%, 0.9)`),c.addColorStop(.5,`hsla(${d}, ${i.saturation}%, ${u-10}%, 0.4)`),c.addColorStop(1,`hsla(${d}, ${i.saturation}%, ${u-20}%, 0)`),t.fillStyle=c,t.beginPath(),t.arc(l,r,m*2,0,p),t.fill(),t.globalCompositeOperation="source-over",t.fillStyle=`hsl(${d}, ${i.saturation}%, ${u+20}%)`,t.beginPath(),t.arc(l,r,m*.5,0,p),t.fill()}}drawCenter(t,e,n){t.globalCompositeOperation="lighter";const o=Math.min(this.width,this.height),a=Math.sin(this.time*2)*.3+1,h=o*i.centerSizeRatio*a,s=t.createRadialGradient(e,n,0,e,n,h);s.addColorStop(0,`hsla(${this.hueOffset%360}, 100%, 80%, 0.8)`),s.addColorStop(.3,`hsla(${(this.hueOffset+30)%360}, 90%, 60%, 0.4)`),s.addColorStop(1,"transparent"),t.fillStyle=s,t.beginPath(),t.arc(e,n,h,0,p),t.fill(),t.globalCompositeOperation="source-over"}}function w(f){const t=new S(f);return t.start(),{stop:()=>t.stop(),game:t}}export{w as default};
