import{G as L,P as D,C as G,Y as A,o as I,z as Z,t as E,M as $,E as X}from"./index-ACZeJgrc.js";const H=Math.PI*2,l={baseMolecules:40,minMolecules:20,maxMolecules:200,perspective:800,heatZone:.85,coolZone:.15,heatRate:.008,buoyancyStrength:80,neutralTemp:.5,baseSpeed:15,damping:.97,floatRadius:60,floatSpeed:.4,floatRandomness:.7,tideStrength:100,tidePeriod:8,heatTransferDist:80,heatTransferRate:.02,reactionDistance:100,reactionCooldown:.3,baseReactionChance:.4,separationPadding:0,separationStiffness:.5,collisionDamping:.25,lightningInterval:4,lightningVariance:2,lightningEnergy:.4,lightningRadius:150,bgColor:"#050510",ventGlow:.4,bubbleCount:40,particleCount:60,causticSpeed:.3},R={PRIMORDIAL:0,PRECURSOR:1,AMINO_ACID:2,PEPTIDE:3},F={C:{radius:18,hue:30,sat:10,light:35,name:"Carbon"},H:{radius:10,hue:200,sat:5,light:90,name:"Hydrogen"},O:{radius:16,hue:0,sat:70,light:50,name:"Oxygen"},N:{radius:15,hue:220,sat:70,light:55,name:"Nitrogen"},S:{radius:20,hue:55,sat:75,light:50,name:"Sulfur"}},T={water:{name:"H₂O",label:"Water",tier:R.PRIMORDIAL,atoms:[{element:"O",x:0,y:0,z:0},{element:"H",x:-15,y:12,z:0},{element:"H",x:15,y:12,z:0}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1}]},methane:{name:"CH₄",label:"Methane",tier:R.PRIMORDIAL,atoms:[{element:"C",x:0,y:0,z:0},{element:"H",x:20,y:20,z:20},{element:"H",x:-20,y:-20,z:20},{element:"H",x:-20,y:20,z:-20},{element:"H",x:20,y:-20,z:-20}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1},{from:0,to:3,order:1},{from:0,to:4,order:1}]},ammonia:{name:"NH₃",label:"Ammonia",tier:R.PRIMORDIAL,atoms:[{element:"N",x:0,y:-8,z:0},{element:"H",x:18,y:10,z:0},{element:"H",x:-9,y:10,z:16},{element:"H",x:-9,y:10,z:-16}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1},{from:0,to:3,order:1}]},hydrogen:{name:"H₂",label:"Hydrogen",tier:R.PRIMORDIAL,atoms:[{element:"H",x:-12,y:0,z:0},{element:"H",x:12,y:0,z:0}],bonds:[{from:0,to:1,order:1}]},carbonDioxide:{name:"CO₂",label:"Carbon Dioxide",tier:R.PRIMORDIAL,atoms:[{element:"C",x:0,y:0,z:0},{element:"O",x:-28,y:0,z:0},{element:"O",x:28,y:0,z:0}],bonds:[{from:0,to:1,order:2},{from:0,to:2,order:2}]},hydrogenSulfide:{name:"H₂S",label:"Hydrogen Sulfide",tier:R.PRIMORDIAL,atoms:[{element:"S",x:0,y:0,z:0},{element:"H",x:-12,y:16,z:0},{element:"H",x:12,y:16,z:0}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1}]},formaldehyde:{name:"CH₂O",label:"Formaldehyde",tier:R.PRECURSOR,atoms:[{element:"C",x:0,y:0,z:0},{element:"O",x:0,y:-24,z:0},{element:"H",x:-18,y:14,z:0},{element:"H",x:18,y:14,z:0}],bonds:[{from:0,to:1,order:2},{from:0,to:2,order:1},{from:0,to:3,order:1}]},hydrogenCyanide:{name:"HCN",label:"Hydrogen Cyanide",tier:R.PRECURSOR,atoms:[{element:"H",x:-30,y:0,z:0},{element:"C",x:0,y:0,z:0},{element:"N",x:26,y:0,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:3}]},glycine:{name:"Glycine",label:"Glycine",tier:R.AMINO_ACID,atoms:[{element:"N",x:-35,y:0,z:0},{element:"C",x:-5,y:0,z:0},{element:"C",x:30,y:0,z:0},{element:"O",x:45,y:-18,z:0},{element:"O",x:45,y:18,z:0},{element:"H",x:-50,y:-10,z:0},{element:"H",x:-50,y:10,z:0},{element:"H",x:-5,y:18,z:10},{element:"H",x:-5,y:18,z:-10},{element:"H",x:58,y:25,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:0,to:5,order:1},{from:0,to:6,order:1},{from:1,to:7,order:1},{from:1,to:8,order:1},{from:4,to:9,order:1}]},alanine:{name:"Alanine",label:"Alanine",tier:R.AMINO_ACID,atoms:[{element:"N",x:-40,y:0,z:0},{element:"C",x:-10,y:0,z:0},{element:"C",x:25,y:0,z:0},{element:"O",x:40,y:-18,z:0},{element:"O",x:40,y:18,z:0},{element:"C",x:-10,y:0,z:28},{element:"H",x:-55,y:-10,z:0},{element:"H",x:-55,y:10,z:0},{element:"H",x:-10,y:20,z:0},{element:"H",x:53,y:25,z:0},{element:"H",x:-10,y:10,z:40},{element:"H",x:-20,y:-8,z:35},{element:"H",x:0,y:-8,z:35}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:1,to:5,order:1},{from:0,to:6,order:1},{from:0,to:7,order:1},{from:1,to:8,order:1},{from:4,to:9,order:1},{from:5,to:10,order:1},{from:5,to:11,order:1},{from:5,to:12,order:1}]},diglycine:{name:"Gly-Gly",label:"Peptide",tier:R.PEPTIDE,atoms:[{element:"N",x:-60,y:0,z:0},{element:"C",x:-35,y:0,z:0},{element:"C",x:-10,y:0,z:0},{element:"O",x:-10,y:-22,z:0},{element:"N",x:15,y:0,z:0},{element:"C",x:40,y:0,z:0},{element:"C",x:65,y:0,z:0},{element:"O",x:80,y:-18,z:0},{element:"O",x:80,y:18,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:4,to:5,order:1},{from:5,to:6,order:1},{from:6,to:7,order:2},{from:6,to:8,order:1}]}},O=["water","methane","ammonia","hydrogen","carbonDioxide","hydrogenSulfide"],j=[{reactants:["methane","water"],products:["formaldehyde","hydrogen"],minTemp:.35,energy:.15},{reactants:["ammonia","methane"],products:["hydrogenCyanide","hydrogen","hydrogen"],minTemp:.4,energy:.2},{reactants:["carbonDioxide","hydrogen"],products:["formaldehyde"],minTemp:.35,energy:.15},{reactants:["formaldehyde","hydrogenCyanide"],products:["glycine"],minTemp:.45,energy:.25},{reactants:["formaldehyde","ammonia"],products:["glycine","water"],minTemp:.5,energy:.3},{reactants:["hydrogenCyanide","ammonia"],products:["alanine"],minTemp:.5,energy:.3},{reactants:["glycine","glycine"],products:["diglycine","water"],minTemp:.55,energy:.4},{reactants:["glycine","alanine"],products:["diglycine","water"],minTemp:.55,energy:.4}];class P extends I{constructor(t,e,o={}){super(t,o),this.templateKey=e,this.template=T[e],this.name=this.template.name,this.label=this.template.label,this.tier=this.template.tier,this.x=o.x??0,this.y=o.y??0,this.z=o.z??0,this.vx=(Math.random()-.5)*l.baseSpeed,this.vy=(Math.random()-.5)*l.baseSpeed,this.vz=(Math.random()-.5)*l.baseSpeed,this.temperature=.5,this.reactionCooldown=0,this.flash=0,this.rotX=Math.random()*H,this.rotY=Math.random()*H,this.rotZ=Math.random()*H,this.rotSpeedX=(Math.random()-.5)*.5,this.rotSpeedY=(Math.random()-.5)*.5,this.rotSpeedZ=(Math.random()-.5)*.2,this.timeOffset=Math.random()*100,this.tideOffset=Math.random()*l.tidePeriod,this.baseX=this.x,this.baseY=this.y,this.baseZ=this.z,this.atomData=this.template.atoms.map(i=>({element:i.element,localX:i.x,localY:i.y,localZ:i.z,props:F[i.element],screenX:0,screenY:0,screenScale:1,worldZ:0})),this.bonds=this.template.bonds;let s=0;for(const i of this.atomData){const a=Math.sqrt(i.localX**2+i.localY**2+i.localZ**2);s=Math.max(s,a+i.props.radius)}this.boundingRadius=s}update(t){super.update(t);const e=this.game,o=e.worldHeight/2,s=e.totalTime,i=(this.baseY+o)/e.worldHeight;this.temperature=Z(Math.max(0,Math.min(1,i)),this.temperature,{heatZone:l.heatZone,coolZone:l.coolZone,rate:l.heatRate});const a=E(this.temperature,l.neutralTemp,l.buoyancyStrength);this.vy-=a*t;const r=Math.pow(l.damping,t*60);this.vx*=r,this.vy*=r,this.vz*=r,this.baseX+=this.vx*t,this.baseY+=this.vy*t,this.baseZ+=this.vz*t;const m=s+this.timeOffset,h=l.floatRadius*(.7+this.temperature*.6),p=$.float({x:0,y:0},m,15,l.floatSpeed*(.8+this.temperature*.4),l.floatRandomness,h,!0,X.smoothstep),y=s+this.tideOffset,d=$.oscillate(-100,l.tideStrength,y,l.tidePeriod,!0,X.easeInOutSine),f=1-i*.4,u=d.value*f;this.x=this.baseX+p.offsetX+u,this.y=this.baseY+p.offsetY*.3,this.z=this.baseZ+p.offsetY*.5;const g=.5+this.temperature*.5;this.rotX+=this.rotSpeedX*g*t,this.rotY+=this.rotSpeedY*g*t,this.rotZ+=this.rotSpeedZ*g*t,this.reactionCooldown>0&&(this.reactionCooldown-=t),this.flash>0&&(this.flash-=t*2)}render(t,e){if(!this.visible)return;const o=D.ctx,s=this.game.camera,i=Math.cos(this.rotX),a=Math.sin(this.rotX),r=Math.cos(this.rotY),m=Math.sin(this.rotY),h=Math.cos(this.rotZ),p=Math.sin(this.rotZ);for(const d of this.atomData){let f=d.localX,u=d.localY,g=d.localZ,n=u*i-g*a,c=u*a+g*i;u=n,g=c;let b=f*r+g*m;c=-f*m+g*r,f=b,g=c,b=f*h-u*p,n=f*p+u*h,f=b,u=n;const x=this.x+f,S=this.y+u,C=this.z+g,M=s.project(x,S,C);d.screenX=t+M.x,d.screenY=e+M.y,d.screenScale=M.scale,d.worldZ=M.z}const y=[...this.atomData].sort((d,f)=>d.worldZ-f.worldZ);this._renderBonds(o);for(const d of y)this._renderAtom(o,d)}_renderBonds(t){for(const e of this.bonds){const o=this.atomData[e.from],s=this.atomData[e.to];if(o.screenScale<=0||s.screenScale<=0)continue;const i=(o.screenScale+s.screenScale)/2,a=(o.worldZ+s.worldZ)/2,r=Math.max(-10,Math.min(10,a/40)),m=200-this.temperature*180,h=45+r;if(t.strokeStyle=`hsl(${m}, 35%, ${h}%)`,t.lineWidth=3*i,t.lineCap="round",e.order===1)t.beginPath(),t.moveTo(o.screenX,o.screenY),t.lineTo(s.screenX,s.screenY),t.stroke();else if(e.order>=2){const p=s.screenX-o.screenX,y=s.screenY-o.screenY,d=Math.sqrt(p*p+y*y)||1,f=4*i,u=-y/d*f,g=p/d*f;t.lineWidth=2*i;for(let n=0;n<e.order;n++){const c=n-(e.order-1)/2;t.beginPath(),t.moveTo(o.screenX+u*c,o.screenY+g*c),t.lineTo(s.screenX+u*c,s.screenY+g*c),t.stroke()}}}}_renderAtom(t,e){if(e.screenScale<=0)return;const o=e.props,s=o.radius*e.screenScale,i=Math.max(-15,Math.min(10,e.worldZ/30)),a=(this.temperature-.5)*40,r=o.hue+a,m=o.sat+this.temperature*20,h=o.light+i;if(this.flash>0){const y=s*(2+this.flash),d=t.createRadialGradient(e.screenX,e.screenY,0,e.screenX,e.screenY,y);d.addColorStop(0,`rgba(255, 255, 200, ${this.flash*.9})`),d.addColorStop(.4,`rgba(255, 180, 80, ${this.flash*.5})`),d.addColorStop(1,"transparent"),t.fillStyle=d,t.beginPath(),t.arc(e.screenX,e.screenY,y,0,H),t.fill()}const p=t.createRadialGradient(e.screenX-s*.3,e.screenY-s*.3,0,e.screenX,e.screenY,s);p.addColorStop(0,`hsl(${r}, ${m*.3}%, ${Math.min(h+35,95)}%)`),p.addColorStop(.4,`hsl(${r}, ${m}%, ${h}%)`),p.addColorStop(1,`hsl(${r}, ${m+10}%, ${Math.max(h-20,10)}%)`),t.fillStyle=p,t.beginPath(),t.arc(e.screenX,e.screenY,s,0,H),t.fill()}getBounds(){return{x:this.x,y:this.y,width:this.boundingRadius*2,height:this.boundingRadius*2}}}class N extends L{constructor(t){super(t),this.backgroundColor=l.bgColor}init(){super.init(),D.init(this.ctx),this.camera=new G({perspective:l.perspective,rotationX:.2,rotationY:0,inertia:!0,friction:.95,clampX:!1,clampY:!1}),this.camera.enableMouseControl(this.canvas),this.canvas.removeEventListener("dblclick",this.camera._boundHandlers.dblclick),this.molecules=[],this.cx=this.width/2,this.cy=this.height/2,this.reactionLog=[],this.totalTime=0,this.nextLightning=l.lightningInterval,this.stats={reactions:0,maxTier:0},this.worldWidth=this.width*.8,this.worldHeight=this.height*.9;const t=1920*1080,o=this.width*this.height/t;this.moleculeCount=Math.floor(Math.min(l.maxMolecules,Math.max(l.minMolecules,l.baseMolecules*o)));const s=Math.floor(l.bubbleCount*Math.max(.5,o)),i=Math.floor(l.particleCount*Math.max(.5,o));console.log(`[Day25] Canvas: ${this.width}x${this.height}, scale: ${o.toFixed(2)}, molecules: ${this.moleculeCount}, bubbles: ${s}, particles: ${i}`),this.bubbles=[];for(let r=0;r<s;r++)this.bubbles.push(this.createBubble(!0));this.particles=[];for(let r=0;r<i;r++)this.particles.push(this.createParticle());for(let r=0;r<this.moleculeCount;r++)this.spawnMolecule(!0);let a=null;this.canvas.addEventListener("mousedown",r=>{a={x:r.clientX,y:r.clientY}}),this.canvas.addEventListener("mouseup",r=>{if(a){const z=r.clientX-a.x,w=r.clientY-a.y;if(Math.abs(z)>5||Math.abs(w)>5){a=null;return}}a=null;const m=this.canvas.getBoundingClientRect(),h=r.clientX-m.left-this.width/2,p=r.clientY-m.top-this.height/2,y=Math.cos(-this.camera.rotationX),d=Math.sin(-this.camera.rotationX),f=Math.cos(-this.camera.rotationY),u=Math.sin(-this.camera.rotationY);let g=h,n=p,c=(Math.random()-.5)*100;const b=g*f-c*u,x=g*u+c*f;g=b,c=x;const S=n*y-c*d,C=n*d+c*y;n=S,c=C;const M=this.spawnMolecule(!0,g,n,c,void 0,!0);M&&(this.reactionLog.unshift({text:`+ ${M.label} (${M.name})`,time:2}),this.reactionLog.length>5&&this.reactionLog.pop())})}createBubble(t=!1){const e=this.width*.3;return{x:this.width/2+(Math.random()-.5)*e,y:t?Math.random()*this.height:this.height+Math.random()*50,size:2+Math.random()*6,speed:30+Math.random()*50,wobblePhase:Math.random()*H,wobbleSpeed:1+Math.random()*2,alpha:.1+Math.random()*.3}}createParticle(){return{x:Math.random()*this.width,y:Math.random()*this.height,z:(Math.random()-.5)*400,size:1+Math.random()*2,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*5,alpha:.05+Math.random()*.15,hue:Math.random()<.3?30:200}}spawnMolecule(t=!1,e,o,s,i,a=!1){const r=Math.min(l.maxMolecules,(this.moleculeCount||l.baseMolecules)*3);if(!a&&this.molecules.length>=r)return null;const m=i||(t?O[Math.floor(Math.random()*O.length)]:Object.keys(T)[Math.floor(Math.random()*Object.keys(T).length)]),h=e??(Math.random()-.5)*this.worldWidth,p=o??(Math.random()-.5)*this.worldHeight,y=s??(Math.random()-.5)*200,d=new P(this,m,{x:h,y:p,z:y});return this.molecules.push(d),d}lightning(){const t=(Math.random()-.5)*this.worldWidth,e=(Math.random()-.5)*this.worldHeight*.5,o=(Math.random()-.5)*150;for(const s of this.molecules){const i=s.x-t,a=s.y-e,r=s.z-o,m=Math.sqrt(i*i+a*a+r*r);if(m<l.lightningRadius){const h=1-m/l.lightningRadius;s.temperature=Math.min(1,s.temperature+l.lightningEnergy*h),s.flash=Math.max(s.flash,h*.5)}}this.lightningFlash={x:t,y:e,z:o,intensity:1}}checkReactions(){const t=new Set,e=[];for(let o=0;o<this.molecules.length;o++){const s=this.molecules[o];if(!(s.reactionCooldown>0||t.has(o)))for(let i=o+1;i<this.molecules.length;i++){const a=this.molecules[i];if(a.reactionCooldown>0||t.has(i))continue;const r=a.x-s.x,m=a.y-s.y,h=a.z-s.z;if(Math.sqrt(r*r+m*m+h*h)>l.reactionDistance)continue;const y=(s.temperature+a.temperature)/2;for(const d of j){const[f,u]=d.reactants;if(!(s.templateKey===f&&a.templateKey===u||s.templateKey===u&&a.templateKey===f))continue;const n=l.baseReactionChance*(y/d.minTemp);if(y<d.minTemp*.8||Math.random()>n)continue;t.add(o),t.add(i);const c=(s.x+a.x)/2,b=(s.y+a.y)/2,x=(s.z+a.z)/2;for(const z of d.products){if(!T[z])continue;const w=(Math.random()-.5)*20,v=new P(this,z,{x:c+w,y:b+w,z:x+w});v.temperature=y,v.flash=d.energy,v.reactionCooldown=l.reactionCooldown,v.vx=(s.vx+a.vx)/2+(Math.random()-.5)*15,v.vy=(s.vy+a.vy)/2+(Math.random()-.5)*15,v.vz=(s.vz+a.vz)/2+(Math.random()-.5)*15,e.push(v),this.stats.maxTier=Math.max(this.stats.maxTier,v.tier)}this.stats.reactions++;const S=z=>`${z.label} (${z.name})`,C=[S(s),S(a)].join(" + "),M=d.products.map(z=>{const w=T[z];return w?`${w.label} (${w.name})`:z}).join(" + ");this.reactionLog.unshift({text:`${C} → ${M}`,time:4}),this.reactionLog.length>5&&this.reactionLog.pop();break}}}this.molecules=this.molecules.filter((o,s)=>!t.has(s));for(const o of e)this.molecules.push(o)}applySeparation(t){const e=l.separationPadding,o=l.separationStiffness,s=l.collisionDamping;for(let i=0;i<this.molecules.length;i++){const a=this.molecules[i],r=a.boundingRadius+e;for(let m=i+1;m<this.molecules.length;m++){const h=this.molecules[m],p=h.boundingRadius+e,y=h.x-a.x,d=h.y-a.y,f=h.z-a.z,u=y*y+d*d+f*f,g=r+p;if(u<g*g&&u>.001){const n=Math.sqrt(u),c=g-n,b=y/n,x=d/n,S=f/n,C=c*o*.5;a.baseX-=b*C,a.baseY-=x*C,a.baseZ-=S*C,h.baseX+=b*C,h.baseY+=x*C,h.baseZ+=S*C;const M=a.vx*b+a.vy*x+a.vz*S,z=h.vx*b+h.vy*x+h.vz*S;if(M>z){const v=(M-z)*s;a.vx-=b*v*.5,a.vy-=x*v*.5,a.vz-=S*v*.5,h.vx+=b*v*.5,h.vy+=x*v*.5,h.vz+=S*v*.5}}}}}heatTransfer(){for(let t=0;t<this.molecules.length;t++){const e=this.molecules[t];for(let o=t+1;o<this.molecules.length;o++){const s=this.molecules[o],i=s.x-e.x,a=s.y-e.y,r=s.z-e.z,m=Math.sqrt(i*i+a*a+r*r);if(m<l.heatTransferDist){const h=A(e.temperature,s.temperature,m,l.heatTransferDist,l.heatTransferRate,1);e.temperature=Math.max(0,Math.min(1,e.temperature+h)),s.temperature=Math.max(0,Math.min(1,s.temperature-h))}}}}update(t){super.update(t),this.camera.update(t),this.totalTime+=t,this.nextLightning-=t,this.nextLightning<=0&&(this.lightning(),this.nextLightning=l.lightningInterval+(Math.random()-.5)*l.lightningVariance*2),this.lightningFlash&&(this.lightningFlash.intensity-=t*3,this.lightningFlash.intensity<=0&&(this.lightningFlash=null));for(const e of this.bubbles)e.y-=e.speed*t,e.wobblePhase+=e.wobbleSpeed*t,e.x+=Math.sin(e.wobblePhase)*.5,e.y<-20&&Object.assign(e,this.createBubble(!1));for(const e of this.particles)e.x+=e.vx*t,e.y+=e.vy*t,e.vx+=(Math.sin(this.totalTime*.5+e.y*.01)*2-e.vx*.1)*t,e.vy+=(Math.cos(this.totalTime*.3+e.x*.01)*1-e.vy*.1)*t,e.x<0&&(e.x=this.width),e.x>this.width&&(e.x=0),e.y<0&&(e.y=this.height),e.y>this.height&&(e.y=0);for(const e of this.molecules){e.update(t);const o=50;e.x<-this.worldWidth/2-o&&(e.vx+=50*t),e.x>this.worldWidth/2+o&&(e.vx-=50*t),e.y<-this.worldHeight/2-o&&(e.vy+=50*t),e.y>this.worldHeight/2+o&&(e.vy-=50*t),e.z<-200&&(e.vz+=30*t),e.z>200&&(e.vz-=30*t)}this.applySeparation(t),this.heatTransfer(),this.checkReactions();for(const e of this.reactionLog)e.time-=t;this.reactionLog=this.reactionLog.filter(e=>e.time>0)}render(){const t=this.ctx,e=this.width,o=this.height,s=e/2,i=o/2,a=t.createLinearGradient(0,0,0,o);a.addColorStop(0,"#030612"),a.addColorStop(.5,"#050510"),a.addColorStop(.8,"#0a0508"),a.addColorStop(1,"#1a0505"),t.fillStyle=a,t.fillRect(0,0,e,o),t.globalAlpha=.03;const r=120,m=this.totalTime*l.causticSpeed;for(let n=0;n<5;n++){const c=n*1.3+m,b=e*.3+Math.sin(c)*e*.2,x=o*.2+Math.cos(c*.7)*o*.1,S=e*.7+Math.sin(c*.8+2)*e*.2,C=o*.3+Math.cos(c*.5+1)*o*.1,M=t.createRadialGradient(b,x,0,b,x,r);M.addColorStop(0,"rgba(100, 180, 255, 1)"),M.addColorStop(1,"transparent"),t.fillStyle=M,t.fillRect(0,0,e,o);const z=t.createRadialGradient(S,C,0,S,C,r*.8);z.addColorStop(0,"rgba(150, 200, 255, 1)"),z.addColorStop(1,"transparent"),t.fillStyle=z,t.fillRect(0,0,e,o)}t.globalAlpha=1;const h=t.createRadialGradient(s,o+50,0,s,o+50,o*.7);h.addColorStop(0,`rgba(255, 100, 30, ${l.ventGlow})`),h.addColorStop(.3,`rgba(255, 60, 10, ${l.ventGlow*.5})`),h.addColorStop(.6,`rgba(200, 30, 5, ${l.ventGlow*.2})`),h.addColorStop(1,"transparent"),t.fillStyle=h,t.fillRect(0,0,e,o);const p=t.createRadialGradient(s-e*.2,o+30,0,s-e*.2,o+30,o*.3);p.addColorStop(0,`rgba(255, 80, 20, ${l.ventGlow*.4})`),p.addColorStop(1,"transparent"),t.fillStyle=p,t.fillRect(0,0,e,o);const y=t.createRadialGradient(s+e*.25,o+40,0,s+e*.25,o+40,o*.35);y.addColorStop(0,`rgba(255, 60, 10, ${l.ventGlow*.3})`),y.addColorStop(1,"transparent"),t.fillStyle=y,t.fillRect(0,0,e,o);for(const n of this.particles){const c=.5+(n.z+200)/400*.5;t.fillStyle=`hsla(${n.hue}, 30%, 60%, ${n.alpha*c})`,t.beginPath(),t.arc(n.x,n.y,n.size*c,0,H),t.fill()}if(this.lightningFlash){const n=this.camera.project(this.lightningFlash.x,this.lightningFlash.y,this.lightningFlash.z),c=s+n.x,b=i+n.y,x=t.createRadialGradient(c,b,0,c,b,250);x.addColorStop(0,`rgba(220, 240, 255, ${this.lightningFlash.intensity*.9})`),x.addColorStop(.2,`rgba(180, 210, 255, ${this.lightningFlash.intensity*.5})`),x.addColorStop(.5,`rgba(100, 150, 255, ${this.lightningFlash.intensity*.2})`),x.addColorStop(1,"transparent"),t.fillStyle=x,t.fillRect(0,0,e,o)}const d=[...this.molecules].sort((n,c)=>{const b=this.camera.project(n.x,n.y,n.z),x=this.camera.project(c.x,c.y,c.z);return b.z-x.z});for(const n of d)n.render(s,i);for(const n of this.bubbles){const c=t.createRadialGradient(n.x-n.size*.3,n.y-n.size*.3,0,n.x,n.y,n.size);c.addColorStop(0,`rgba(255, 255, 255, ${n.alpha*.8})`),c.addColorStop(.5,`rgba(200, 220, 255, ${n.alpha*.3})`),c.addColorStop(1,`rgba(150, 180, 220, ${n.alpha*.1})`),t.fillStyle=c,t.beginPath(),t.arc(n.x,n.y,n.size,0,H),t.fill(),t.fillStyle=`rgba(255, 255, 255, ${n.alpha*.6})`,t.beginPath(),t.arc(n.x-n.size*.3,n.y-n.size*.3,n.size*.25,0,H),t.fill()}const f=t.createRadialGradient(s,i,Math.min(e,o)*.3,s,i,Math.max(e,o)*.8);f.addColorStop(0,"transparent"),f.addColorStop(1,"rgba(0, 5, 15, 0.6)"),t.fillStyle=f,t.fillRect(0,0,e,o),t.font='11px "Fira Code", monospace',t.textAlign="left";let u=25;for(const n of this.reactionLog){const c=Math.min(1,n.time);t.fillStyle=`rgba(255, 200, 100, ${c*.9})`,t.fillText(n.text,15,u),u+=18}t.fillStyle="rgba(150, 180, 200, 0.6)",t.textAlign="right",t.fillText(`Molecules: ${this.molecules.length}`,e-15,25),t.fillText(`Reactions: ${this.stats.reactions}`,e-15,43);const g=["Primordial","Precursors","Amino Acids","Peptides"];t.fillText(`Max tier: ${g[this.stats.maxTier]||"???"}`,e-15,61),t.textAlign="center",t.fillStyle="rgba(150, 150, 150, 0.4)",t.fillText("Click to add molecules. Drag to orbit. Watch complexity emerge.",s,o-15)}}function _(Y){const t=new N(Y);return t.start(),{stop:()=>t.stop(),game:t}}export{_ as default};
