import{G as v,P as d}from"./index-DMqzgpv5.js";const a={goldenAngle:137.5077640500378,numSeeds:1e3,baseRadiusRatio:.015,spacingRatio:.012,pulseSpeed:1.5,rotationSpeed:.15,waveSpeed:2,waveAmplitudeRatio:.03,hueSpeed:30,saturation:85,mouseRadiusRatio:.25,mouseForceRatio:.15,explosionForceRatio:.5,explosionDecay:.96,centerSizeRatio:.04},x=Math.PI*2,M=a.goldenAngle*Math.PI/180;class R extends v{constructor(s){super(s),this.backgroundColor="#000"}init(){super.init(),d.init(this.ctx),this.time=0,this.hueOffset=0,this.globalRotation=0,this.mouseX=0,this.mouseY=0,this.exploding=!1,this.explosionTime=0;const n=Math.min(this.width,this.height)*a.spacingRatio;this.seeds=[];for(let e=0;e<a.numSeeds;e++){const i=e*M,o=Math.sqrt(e);this.seeds.push({index:e,baseAngle:i,radiusFactor:o,angle:i,radius:o*n,vx:0,vy:0,sizeFactor:Math.max(.3,1-e*5e-4),phase:Math.random()*x})}this.canvas.addEventListener("mousemove",e=>{const i=this.canvas.getBoundingClientRect();this.mouseX=e.clientX-i.left-this.width/2,this.mouseY=e.clientY-i.top-this.height/2}),this.canvas.addEventListener("click",()=>{this.explode()}),this.canvas.addEventListener("mouseleave",()=>{this.mouseX=0,this.mouseY=0}),this.canvas.addEventListener("touchmove",e=>{e.preventDefault();const i=this.canvas.getBoundingClientRect(),o=e.touches[0];this.mouseX=o.clientX-i.left-this.width/2,this.mouseY=o.clientY-i.top-this.height/2},{passive:!1}),this.canvas.addEventListener("touchend",e=>{this.explode(),this.mouseX=0,this.mouseY=0})}explode(){this.exploding=!0,this.explosionTime=this.time;const s=Math.min(this.width,this.height),n=s*a.explosionForceRatio,e=s*a.spacingRatio;for(const i of this.seeds){const o=i.radiusFactor*e,h=Math.cos(i.angle)*o,t=Math.sin(i.angle)*o,c=Math.sqrt(h*h+t*t)+1,r=n/Math.sqrt(c+50),l=s*.06;i.vx=h/c*r+(Math.random()-.5)*l,i.vy=t/c*r+(Math.random()-.5)*l}}update(s){super.update(s),this.time+=s,this.hueOffset+=a.hueSpeed*s,this.globalRotation+=a.rotationSpeed*s;const n=Math.min(this.width,this.height),e=n*a.spacingRatio,i=n*a.waveAmplitudeRatio,o=n*a.mouseRadiusRatio,h=n*a.mouseForceRatio;for(const t of this.seeds){const c=t.radiusFactor*e;let r=Math.cos(t.angle)*t.radius,l=Math.sin(t.angle)*t.radius;if(this.exploding){r+=t.vx*s,l+=t.vy*s,t.vx*=a.explosionDecay,t.vy*=a.explosionDecay;const g=Math.cos(t.baseAngle+this.globalRotation)*c,u=Math.sin(t.baseAngle+this.globalRotation)*c,m=g-r,p=u-l;t.vx+=m*2*s,t.vy+=p*2*s,t.angle=Math.atan2(l+t.vy*s,r+t.vx*s),t.radius=Math.sqrt((r+t.vx*s)**2+(l+t.vy*s)**2),this.time-this.explosionTime>3&&(this.exploding=!1)}else{t.angle=t.baseAngle+this.globalRotation;const g=Math.sin(this.time*a.pulseSpeed+t.index*.02)*.1+1,u=Math.sin(this.time*a.waveSpeed-c*.05)*i;t.radius=c*g+u*c/(n*.25);const m=Math.sqrt((r-this.mouseX)**2+(l-this.mouseY)**2);if(m<o){const p=(o-m)/o;t.radius+=p*h*(1-t.index/a.numSeeds),t.angle+=p*.3*Math.sin(this.time*5)}}}}render(){d.shapes.rect(0,0,this.width,this.height,"rgba(0, 0, 0, 0.15)");const s=this.width/2,n=this.height/2;this.drawConnections(s,n),this.drawSeeds(s,n),this.drawCenter(s,n)}drawConnections(s,n){this.ctx.beginPath();for(let e=1;e<Math.min(500,this.seeds.length);e++){const i=this.seeds[e],o=this.seeds[e-1],h=s+Math.cos(o.angle)*o.radius,t=n+Math.sin(o.angle)*o.radius,c=s+Math.cos(i.angle)*i.radius,r=n+Math.sin(i.angle)*i.radius;this.ctx.moveTo(h,t),this.ctx.lineTo(c,r)}d.colors.stroke(`hsla(${this.hueOffset%360}, 70%, 50%, 0.05)`,.5)}drawSeeds(s,n){const i=Math.min(this.width,this.height)*a.baseRadiusRatio;for(let o=this.seeds.length-1;o>=0;o--){const h=this.seeds[o],t=s+Math.cos(h.angle)*h.radius,c=n+Math.sin(h.angle)*h.radius,r=(h.index*.5+this.hueOffset)%360,l=50+Math.sin(this.time*3+h.phase)*15,g=Math.sin(this.time*4+h.index*.1)*.3+1,u=i*h.sizeFactor*g;if(!isFinite(u)||u<=0||!isFinite(t)||!isFinite(c))continue;d.effects.setBlendMode("lighter");const m=d.colors.radialGradient(t,c,0,t,c,u*2,[{offset:0,color:`hsla(${r}, ${a.saturation}%, ${l}%, 0.9)`},{offset:.5,color:`hsla(${r}, ${a.saturation}%, ${l-10}%, 0.4)`},{offset:1,color:`hsla(${r}, ${a.saturation}%, ${l-20}%, 0)`}]);d.shapes.fillCircle(t,c,u*2,m),d.effects.setBlendMode("source-over"),d.shapes.fillCircle(t,c,u*.5,`hsl(${r}, ${a.saturation}%, ${l+20}%)`)}}drawCenter(s,n){d.effects.setBlendMode("lighter");const e=Math.min(this.width,this.height),i=Math.sin(this.time*2)*.3+1,o=e*a.centerSizeRatio*i,h=d.colors.radialGradient(s,n,0,s,n,o,[{offset:0,color:`hsla(${this.hueOffset%360}, 100%, 80%, 0.8)`},{offset:.3,color:`hsla(${(this.hueOffset+30)%360}, 90%, 60%, 0.4)`},{offset:1,color:"transparent"}]);d.shapes.fillCircle(s,n,o,h),d.effects.setBlendMode("source-over")}}function S(f){const s=new R(f);return s.start(),{stop:()=>s.stop(),game:s}}export{S as default};
