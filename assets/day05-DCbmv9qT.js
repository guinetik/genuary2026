import{G as q,P as _,N as z,C as N,U as L,b as $,E as O,c as Z}from"./index-BijcbkZy.js";const o={pixelSize:14,letterSpacing:2,particlesPerPixel:10,zSpread:10,fingerprintSpacing:6,fingerprintThickness:.7,maxParticles:15e3,particleSize:{min:2,max:3.5},dashLength:3.5,dashWidth:.8,initialRings:3,rippleBaseRadius:50,rippleSpacing:70,rippleParticlesBase:35,rippleParticlesGrowth:4,rippleSpeed:.4,rippleEccentricity:.6,pulsePeriod:1,pulseStrength:12,pulseVibration:3,shockwaveSpeed:300,shockwaveStrength:15,spawnDuration:1.8,gDelay:0,driftDuration:8,breatheAmount:.6,breatheSpeed:1,perspective:800,sensitivity:.004,mouseRadius:160,mousePush:700},F={G:[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,0],[1,0,1,1,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],E:[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]],N:[[1,0,0,0,1],[1,1,0,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,0,1,1],[1,0,0,0,1],[1,0,0,0,1]],U:[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],A:[[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1]],R:[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0],[1,0,1,0,0],[1,0,0,1,0],[1,0,0,0,1]],Y:[[1,0,0,0,1],[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]};function Q(y){const t=[],n=y.split(""),c=5,r=7,{pixelSize:s,letterSpacing:e,particlesPerPixel:h,zSpread:i}=o,u=-(n.length*c*s+(n.length-1)*e*s)/2,l=-r*s/2;return n.forEach((m,g)=>{const d=F[m];if(!d)return;const f=u+g*(c+e)*s,p=f+c*s/2,M=0;for(let b=0;b<r;b++)for(let x=0;x<c;x++)if(d[b][x]===1){const P=f+x*s+s/2,R=l+b*s+s/2;for(let w=0;w<h;w++){const D=(Math.random()-.5)*s*.75,E=(Math.random()-.5)*s*.75,k=(Math.random()-.5)*i,S=P+D,v=R+E;{const X=S-p,Y=v-M,U=Math.sqrt(X*X+Y*Y),I=Math.atan2(Y,X),T=U+I*10,W=Math.sin(T*Math.PI*2/o.fingerprintSpacing),G=o.fingerprintThickness;if(Math.abs(W)>G&&Math.random()>.4)continue}const C=S-p,A=v-M,B=Math.atan2(A,C)+Math.PI/2+(Math.random()-.5)*.2;t.push({x:S,y:v,z:k,letterIndex:g,letterCenterX:p,letterCenterY:M,angle:B,brightness:.7+Math.random()*.3,phase:(S+v)*.02+Math.random()*.5})}}}),t}class V extends Z{drawParticle(t,n,c,r,s){var i,a,u;const e=((i=n.color)==null?void 0:i.a)??1,h=n.size*s;if(!(h<.3||e<=0))if((a=n.custom)!=null&&a.isLetter&&((u=n.custom)==null?void 0:u.angle)!==void 0){const{r:l,g:m,b:g}=n.color,d=n.custom.angle,f=n.custom.glow||0,p=n.custom.dashScale??1,M=h*.5,b=h*o.dashLength,x=M+(b-M)*p,P=h*.8,R=h*o.dashWidth,w=P+(R-P)*p;t.save(),t.translate(c,r),t.rotate(d),t.lineCap="round",t.strokeStyle=`rgba(${Math.floor(l)},${Math.floor(m)},${Math.floor(g)},${e})`,t.lineWidth=Math.max(.5,w),t.beginPath(),t.moveTo(-x/2,0),t.lineTo(x/2,0),t.stroke(),f>.15&&(t.strokeStyle=`rgba(255,255,255,${e*.4*f})`,t.lineWidth=w*2,t.stroke()),t.restore()}else super.drawParticle(t,n,c,r,s)}}class j extends q{constructor(t){super(t),this.backgroundColor="#000"}init(){super.init(),_.init(this.ctx),this.time=0,this.mouseX=-9999,this.mouseY=-9999,this.pulseStartTime=o.gDelay+o.spawnDuration,this.lastPulseBeat=0,this.shockwaves=[],this.currentRingCount=o.initialRings,z.seed(42),this.camera=new N({perspective:o.perspective,rotationX:0,rotationY:0,sensitivity:o.sensitivity,inertia:!0,friction:.95,clampX:!1}),this.camera.enableMouseControl(this.canvas),this.targetPositions=Q("GENUARY");const t=this.targetPositions.filter(i=>i.letterIndex===0);if(t.length>0){const i=t.reduce((u,l)=>u+l.x,0),a=t.reduce((u,l)=>u+l.y,0);this.orbitOrigin={x:i/t.length,y:a/t.length}}else this.orbitOrigin={x:-200,y:0};this.globalOffset={x:-this.orbitOrigin.x,y:-this.orbitOrigin.y};const n=this.createRippleUpdater(),c=this.createSpawnUpdater(),r=this.createBreatheUpdater(),s=this.createMouseUpdater(),e=this.createPulseUpdater();this.particles=new V(this,{camera:this.camera,depthSort:!0,maxParticles:o.maxParticles,blendMode:"screen",updaters:[n,c,r,s,e,L.velocity,L.damping(.94)]});const h=new $({rate:0,lifetime:{min:999,max:999},size:o.particleSize,color:{r:200,g:200,b:200,a:.8}});this.particles.addEmitter("text",h),this.spawnLetterParticles(),this.spawnRippleParticles(),this.pipeline.add(this.particles),console.log(`[Day5] GENUARY: ${this.targetPositions.length} letter + ${this.particles.particles.length-this.targetPositions.length} ripple particles`),this._onMouseMove=i=>{const a=this.canvas.getBoundingClientRect();this.mouseX=i.clientX-a.left,this.mouseY=i.clientY-a.top},this._onMouseLeave=()=>{this.mouseX=-9999,this.mouseY=-9999},this.canvas.addEventListener("mousemove",this._onMouseMove),this.canvas.addEventListener("mouseleave",this._onMouseLeave)}spawnLetterParticles(){const t=this.particles.getEmitter("text"),n=this.orbitOrigin.x,c=this.orbitOrigin.y;for(const r of this.targetPositions){const s=this.particles.acquire();t.emit(s);const e=r.x-n,h=r.y-c,i=Math.atan2(h,e),a=Math.sqrt(e*e+(h/o.rippleEccentricity)**2),u=Math.max(o.rippleBaseRadius,a*.8),l=i+(Math.random()-.5)*.5,m=u+o.rippleSpacing+(Math.random()-.5)*20;s.x=n+Math.cos(l)*m,s.y=c+Math.sin(l)*m*o.rippleEccentricity,s.z=(Math.random()-.5)*10,s.custom.targetX=r.x,s.custom.targetY=r.y,s.custom.targetZ=r.z,s.custom.letterCenterX=r.letterCenterX,s.custom.letterCenterY=r.letterCenterY,s.custom.phase=r.phase,s.custom.brightness=r.brightness,s.custom.baseBrightness=r.brightness,s.custom.isLetter=!0,s.custom.letterIndex=r.letterIndex,s.custom.glow=0,s.custom.targetAngle=r.angle,s.custom.startAngle=i+(Math.random()-.5)*.3,s.custom.angle=s.custom.startAngle,s.custom.targetDashScale=1,s.custom.dashScale=0;const g=o.gDelay+r.letterIndex*o.pulsePeriod,d=Math.random()*.3;s.custom.spawnDelay=g+d,s.custom.spawnProgress=0,s.color.r=255,s.color.g=255,s.color.b=255,s.color.a=0,s.custom.targetSize=o.particleSize.min+Math.random()*(o.particleSize.max-o.particleSize.min),s.size=2,this.particles.particles.push(s)}}spawnRippleParticles(){for(let t=0;t<o.initialRings;t++)this.spawnRing(t)}spawnRingAtCenter(){const t=this.particles.getEmitter("text"),n=this.orbitOrigin.x,c=this.orbitOrigin.y,r=o.rippleParticlesBase;for(let s=0;s<r;s++){const e=this.particles.acquire();t.emit(e);const h=s/r*Math.PI*2+Math.random()*.1;e.x=n+Math.cos(h)*10,e.y=c+Math.sin(h)*10*o.rippleEccentricity,e.z=(Math.random()-.5)*10,e.custom.isLetter=!1,e.custom.isRipple=!0,e.custom.originX=n,e.custom.originY=c,e.custom.angle=h,e.custom.ringIndex=0,e.custom.orbitDirection=1,e.custom.targetRadius=o.rippleBaseRadius,e.custom.currentRadius=10,e.custom.expandSpeed=o.shockwaveSpeed*.8,e.custom.expanding=!0;const i=.5+Math.random()*.4;e.custom.brightness=i;const a=Math.floor(180+i*60);e.color.r=a,e.color.g=a,e.color.b=a,e.color.a=.6+i*.3,e.size=1.8+Math.random()*.6,this.particles.particles.push(e)}}spawnRing(t){const n=this.particles.getEmitter("text"),c=this.orbitOrigin.x,r=this.orbitOrigin.y,s=o.rippleBaseRadius+t*o.rippleSpacing,e=o.rippleParticlesBase+t*o.rippleParticlesGrowth;for(let h=0;h<e;h++){const i=this.particles.acquire();n.emit(i);const a=h/e*Math.PI*2+Math.random()*.1;i.x=c+Math.cos(a)*10,i.y=r+Math.sin(a)*10*o.rippleEccentricity,i.z=(Math.random()-.5)*10,i.custom.isLetter=!1,i.custom.isRipple=!0,i.custom.originX=c,i.custom.originY=r,i.custom.angle=a,i.custom.ringIndex=t,i.custom.orbitDirection=t%2===0?1:-1,i.custom.targetRadius=s,i.custom.currentRadius=10,i.custom.expandSpeed=o.shockwaveSpeed*.8,i.custom.expanding=!0;const u=.5+Math.random()*.4;i.custom.brightness=u;const l=Math.floor(180+u*60);i.color.r=l,i.color.g=l,i.color.b=l,i.color.a=.6+u*.3,i.size=1.8+Math.random()*.6,this.particles.particles.push(i)}}createRippleUpdater(){return(t,n)=>{if(!t.custom.isRipple)return;const c=Math.sqrt(this.width*this.width+this.height*this.height)*1;if(t.custom.currentRadius>c){t.custom.dead=!0;return}t.custom.expanding&&(t.custom.currentRadius+=t.custom.expandSpeed*n,t.custom.currentRadius>=t.custom.targetRadius&&(t.custom.currentRadius=t.custom.targetRadius,t.custom.expanding=!1)),t.custom.rx=t.custom.currentRadius,t.custom.ry=t.custom.currentRadius*o.rippleEccentricity,t.custom.angle+=o.rippleSpeed*t.custom.orbitDirection*n/(1+t.custom.ringIndex*.05);const r=t.custom.originX+Math.cos(t.custom.angle)*t.custom.rx,s=t.custom.originY+Math.sin(t.custom.angle)*t.custom.ry,e=Math.sin(this.time*.8+t.custom.angle*2)*3;t.x+=(r-t.x)*.12,t.y+=(s+e-t.y)*.12}}createSpawnUpdater(){return(t,n)=>{if(!t.custom.isLetter)return;if(this.time-t.custom.spawnDelay<0){t.color.a=0;return}if(t.custom.startX===void 0&&(t.custom.startX=t.x,t.custom.startY=t.y,t.custom.startZ=t.z),t.custom.spawnProgress>=1)return;t.custom.spawnProgress=Math.min(1,(t.custom.spawnProgress||0)+n/o.spawnDuration);const r=O.easeOutElastic(t.custom.spawnProgress),s=O.easeOutQuad(t.custom.spawnProgress);t.x=t.custom.startX+(t.custom.targetX-t.custom.startX)*r,t.y=t.custom.startY+(t.custom.targetY-t.custom.startY)*r,t.z=t.custom.startZ+((t.custom.targetZ||0)-t.custom.startZ)*s,t.custom.angle=t.custom.startAngle+(t.custom.targetAngle-t.custom.startAngle)*r,t.custom.dashScale=s;const e=1,h=t.custom.targetSize||o.particleSize.min;t.size=e+(h-e)*s,t.color.a=t.custom.brightness*Math.min(1,s*1.5);const i=Math.floor(180+t.custom.brightness*75),a=Math.floor(255-(255-i)*r);t.color.r=a,t.color.g=a,t.color.b=a}}createBreatheUpdater(){return(t,n)=>{if(!t.custom.isLetter||t.custom.spawnProgress<1)return;const c=t.custom.phase||0,r=Math.sin(this.time*o.breatheSpeed+c)*o.breatheAmount,s=t.custom.targetX+r,e=t.custom.targetY+r*.5,i=.15*(1-(t.custom.mousePush||0)*.7);t.x+=(s-t.x)*i,t.y+=(e-t.y)*i,t.vx*=.8,t.vy*=.8;const a=z.simplex3(t.x*.01,t.y*.01,this.time*.3)*.08;t.custom.angle+=a*n}}createMouseUpdater(){return(t,n)=>{if(this.mouseX<0){t.custom.mousePush=0;return}const c=this.camera.project(t.x,t.y,t.z),r=this.width/2+c.x+this.globalOffset.x,s=this.height/2+c.y+this.globalOffset.y,e=r-this.mouseX,h=s-this.mouseY,i=Math.sqrt(e*e+h*h);if(i<o.mouseRadius&&i>1){const a=1-i/o.mouseRadius,u=a*a*o.mousePush,l=e/i*u*n,m=h/i*u*n;t.x+=l,t.y+=m,t.vx+=l*.5,t.vy+=m*.5,t.custom.mousePush=a,t.custom.isLetter&&(t.custom.brightness=Math.min(1,t.custom.baseBrightness+.4),t.custom.glow=Math.min(1,(t.custom.glow||0)+n*6))}else t.custom.mousePush=Math.max(0,(t.custom.mousePush||0)-n*8),t.custom.isLetter&&t.custom.spawnProgress>=1&&(t.custom.brightness=t.custom.baseBrightness,t.custom.glow=Math.max(0,(t.custom.glow||0)-n*4));if(t.custom.isLetter){const a=Math.floor(180+t.custom.brightness*75);t.color.r=a,t.color.g=a,t.color.b=a}}}createPulseUpdater(){return(t,n)=>{if(!(this.time<o.gDelay)){if(t.custom.isLetter&&t.custom.spawnProgress>=1){const c=t.custom.targetX-this.orbitOrigin.x,r=t.custom.targetY-this.orbitOrigin.y,s=Math.sqrt(c*c+r*r)||1;let e=0;for(const g of this.shockwaves){const d=Math.abs(s-g.radius),f=120;if(d<f){const p=1-d/f,M=(this.time-g.startTime)/o.pulsePeriod,b=Math.max(0,1-M*.5);e=Math.max(e,O.easeOutElastic(p)*b)}}const h=o.pulseStrength*e;let i=0,a=0;if(e>.1){const g=o.pulseVibration*e;i=(Math.random()-.5)*g,a=(Math.random()-.5)*g}const u=t.custom.targetX+c/s*h+i,l=t.custom.targetY+r/s*h+a;t.x+=(u-t.x)*.18,t.y+=(l-t.y)*.18;const m=e*30;t.color.r=Math.min(255,180+t.custom.brightness*75+m),t.color.g=Math.min(255,180+t.custom.brightness*75+m),t.color.b=Math.min(255,180+t.custom.brightness*75+m)}if(t.custom.isRipple){const c=t.x-this.orbitOrigin.x,r=t.y-this.orbitOrigin.y,s=Math.sqrt(c*c+r*r)||1;for(const e of this.shockwaves){const h=Math.abs(s-e.radius),i=60;if(h<i){const a=1-h/i,u=(this.time-e.startTime)/o.pulsePeriod,l=Math.max(0,1-u),m=o.shockwaveStrength*a*l*n;t.x+=c/s*m,t.y+=r/s*m,t.color.a=Math.min(1,(t.color.a||.6)+.15*a*l)}}}}}}stop(){super.stop(),this.camera&&this.camera.disableMouseControl(),this._onMouseMove&&this.canvas.removeEventListener("mousemove",this._onMouseMove),this._onMouseLeave&&this.canvas.removeEventListener("mouseleave",this._onMouseLeave)}update(t){var e;super.update(t),this.time+=t,this.camera.update(t);const n=Math.min(1,this.time/o.driftDuration),c=this.easeInOutQuad(n),r=-this.orbitOrigin.x,s=-this.orbitOrigin.y;if(this.globalOffset.x=r*(1-c),this.globalOffset.y=s*(1-c),this.time>=o.gDelay){const h=this.time-o.gDelay,i=Math.floor(h/o.pulsePeriod);if(i>this.lastPulseBeat){this.lastPulseBeat=i,this.shockwaves.push({startTime:this.time,radius:0});for(const a of this.particles.particles)(e=a.custom)!=null&&e.isRipple&&(a.custom.targetRadius+=o.rippleSpacing,a.custom.expanding=!0);this.particles.particles.length<o.maxParticles&&this.spawnRingAtCenter()}this.shockwaves=this.shockwaves.filter(a=>(a.radius=(this.time-a.startTime)*o.shockwaveSpeed,a.radius<1500)).slice(-5),this.particles.particles=this.particles.particles.filter(a=>{var u;return!((u=a.custom)!=null&&u.dead)})}}easeInOutQuad(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}render(){this.ctx.fillStyle="rgba(0, 0, 0, 0.6)",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.save(),this.ctx.translate(this.globalOffset.x,this.globalOffset.y),this.pipeline.render(this.ctx),this.ctx.restore()}}function J(y){const t=new j(y);return t.start(),{stop:()=>t.stop(),game:t}}export{J as default};
