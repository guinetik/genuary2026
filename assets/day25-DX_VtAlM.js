import{G,P as D,C as L,O as A,n as I,z as Z,t as E,M as O,E as X}from"./gcanvas.es-Dc5p5ZkO.js";const w=Math.PI*2,h={initialCount:40,maxMolecules:150,perspective:800,heatZone:.85,coolZone:.15,heatRate:.008,buoyancyStrength:80,neutralTemp:.5,baseSpeed:15,damping:.97,floatRadius:60,floatSpeed:.4,floatRandomness:.7,tideStrength:100,tidePeriod:8,heatTransferDist:80,heatTransferRate:.02,reactionDistance:100,reactionCooldown:.3,baseReactionChance:.4,separationPadding:0,separationStiffness:.5,collisionDamping:.25,lightningInterval:4,lightningVariance:2,lightningEnergy:.4,lightningRadius:150,bgColor:"#050510",ventGlow:.4,bubbleCount:40,particleCount:60,causticSpeed:.3},R={PRIMORDIAL:0,PRECURSOR:1,AMINO_ACID:2,PEPTIDE:3},F={C:{radius:18,hue:30,sat:10,light:35,name:"Carbon"},H:{radius:10,hue:200,sat:5,light:90,name:"Hydrogen"},O:{radius:16,hue:0,sat:70,light:50,name:"Oxygen"},N:{radius:15,hue:220,sat:70,light:55,name:"Nitrogen"},S:{radius:20,hue:55,sat:75,light:50,name:"Sulfur"}},T={water:{name:"H₂O",label:"Water",tier:R.PRIMORDIAL,atoms:[{element:"O",x:0,y:0,z:0},{element:"H",x:-15,y:12,z:0},{element:"H",x:15,y:12,z:0}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1}]},methane:{name:"CH₄",label:"Methane",tier:R.PRIMORDIAL,atoms:[{element:"C",x:0,y:0,z:0},{element:"H",x:20,y:20,z:20},{element:"H",x:-20,y:-20,z:20},{element:"H",x:-20,y:20,z:-20},{element:"H",x:20,y:-20,z:-20}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1},{from:0,to:3,order:1},{from:0,to:4,order:1}]},ammonia:{name:"NH₃",label:"Ammonia",tier:R.PRIMORDIAL,atoms:[{element:"N",x:0,y:-8,z:0},{element:"H",x:18,y:10,z:0},{element:"H",x:-9,y:10,z:16},{element:"H",x:-9,y:10,z:-16}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1},{from:0,to:3,order:1}]},hydrogen:{name:"H₂",label:"Hydrogen",tier:R.PRIMORDIAL,atoms:[{element:"H",x:-12,y:0,z:0},{element:"H",x:12,y:0,z:0}],bonds:[{from:0,to:1,order:1}]},carbonDioxide:{name:"CO₂",label:"Carbon Dioxide",tier:R.PRIMORDIAL,atoms:[{element:"C",x:0,y:0,z:0},{element:"O",x:-28,y:0,z:0},{element:"O",x:28,y:0,z:0}],bonds:[{from:0,to:1,order:2},{from:0,to:2,order:2}]},hydrogenSulfide:{name:"H₂S",label:"Hydrogen Sulfide",tier:R.PRIMORDIAL,atoms:[{element:"S",x:0,y:0,z:0},{element:"H",x:-12,y:16,z:0},{element:"H",x:12,y:16,z:0}],bonds:[{from:0,to:1,order:1},{from:0,to:2,order:1}]},formaldehyde:{name:"CH₂O",label:"Formaldehyde",tier:R.PRECURSOR,atoms:[{element:"C",x:0,y:0,z:0},{element:"O",x:0,y:-24,z:0},{element:"H",x:-18,y:14,z:0},{element:"H",x:18,y:14,z:0}],bonds:[{from:0,to:1,order:2},{from:0,to:2,order:1},{from:0,to:3,order:1}]},hydrogenCyanide:{name:"HCN",label:"Hydrogen Cyanide",tier:R.PRECURSOR,atoms:[{element:"H",x:-30,y:0,z:0},{element:"C",x:0,y:0,z:0},{element:"N",x:26,y:0,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:3}]},glycine:{name:"Glycine",label:"Glycine",tier:R.AMINO_ACID,atoms:[{element:"N",x:-35,y:0,z:0},{element:"C",x:-5,y:0,z:0},{element:"C",x:30,y:0,z:0},{element:"O",x:45,y:-18,z:0},{element:"O",x:45,y:18,z:0},{element:"H",x:-50,y:-10,z:0},{element:"H",x:-50,y:10,z:0},{element:"H",x:-5,y:18,z:10},{element:"H",x:-5,y:18,z:-10},{element:"H",x:58,y:25,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:0,to:5,order:1},{from:0,to:6,order:1},{from:1,to:7,order:1},{from:1,to:8,order:1},{from:4,to:9,order:1}]},alanine:{name:"Alanine",label:"Alanine",tier:R.AMINO_ACID,atoms:[{element:"N",x:-40,y:0,z:0},{element:"C",x:-10,y:0,z:0},{element:"C",x:25,y:0,z:0},{element:"O",x:40,y:-18,z:0},{element:"O",x:40,y:18,z:0},{element:"C",x:-10,y:0,z:28},{element:"H",x:-55,y:-10,z:0},{element:"H",x:-55,y:10,z:0},{element:"H",x:-10,y:20,z:0},{element:"H",x:53,y:25,z:0},{element:"H",x:-10,y:10,z:40},{element:"H",x:-20,y:-8,z:35},{element:"H",x:0,y:-8,z:35}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:1,to:5,order:1},{from:0,to:6,order:1},{from:0,to:7,order:1},{from:1,to:8,order:1},{from:4,to:9,order:1},{from:5,to:10,order:1},{from:5,to:11,order:1},{from:5,to:12,order:1}]},diglycine:{name:"Gly-Gly",label:"Peptide",tier:R.PEPTIDE,atoms:[{element:"N",x:-60,y:0,z:0},{element:"C",x:-35,y:0,z:0},{element:"C",x:-10,y:0,z:0},{element:"O",x:-10,y:-22,z:0},{element:"N",x:15,y:0,z:0},{element:"C",x:40,y:0,z:0},{element:"C",x:65,y:0,z:0},{element:"O",x:80,y:-18,z:0},{element:"O",x:80,y:18,z:0}],bonds:[{from:0,to:1,order:1},{from:1,to:2,order:1},{from:2,to:3,order:2},{from:2,to:4,order:1},{from:4,to:5,order:1},{from:5,to:6,order:1},{from:6,to:7,order:2},{from:6,to:8,order:1}]}},P=["water","methane","ammonia","hydrogen","carbonDioxide","hydrogenSulfide"],j=[{reactants:["methane","water"],products:["formaldehyde","hydrogen"],minTemp:.35,energy:.15},{reactants:["ammonia","methane"],products:["hydrogenCyanide","hydrogen","hydrogen"],minTemp:.4,energy:.2},{reactants:["carbonDioxide","hydrogen"],products:["formaldehyde"],minTemp:.35,energy:.15},{reactants:["formaldehyde","hydrogenCyanide"],products:["glycine"],minTemp:.45,energy:.25},{reactants:["formaldehyde","ammonia"],products:["glycine","water"],minTemp:.5,energy:.3},{reactants:["hydrogenCyanide","ammonia"],products:["alanine"],minTemp:.5,energy:.3},{reactants:["glycine","glycine"],products:["diglycine","water"],minTemp:.55,energy:.4},{reactants:["glycine","alanine"],products:["diglycine","water"],minTemp:.55,energy:.4}];class $ extends I{constructor(t,e,o={}){super(t,o),this.templateKey=e,this.template=T[e],this.name=this.template.name,this.label=this.template.label,this.tier=this.template.tier,this.x=o.x??0,this.y=o.y??0,this.z=o.z??0,this.vx=(Math.random()-.5)*h.baseSpeed,this.vy=(Math.random()-.5)*h.baseSpeed,this.vz=(Math.random()-.5)*h.baseSpeed,this.temperature=.5,this.reactionCooldown=0,this.flash=0,this.rotX=Math.random()*w,this.rotY=Math.random()*w,this.rotZ=Math.random()*w,this.rotSpeedX=(Math.random()-.5)*.5,this.rotSpeedY=(Math.random()-.5)*.5,this.rotSpeedZ=(Math.random()-.5)*.2,this.timeOffset=Math.random()*100,this.tideOffset=Math.random()*h.tidePeriod,this.baseX=this.x,this.baseY=this.y,this.baseZ=this.z,this.atomData=this.template.atoms.map(i=>({element:i.element,localX:i.x,localY:i.y,localZ:i.z,props:F[i.element],screenX:0,screenY:0,screenScale:1,worldZ:0})),this.bonds=this.template.bonds;let n=0;for(const i of this.atomData){const a=Math.sqrt(i.localX**2+i.localY**2+i.localZ**2);n=Math.max(n,a+i.props.radius)}this.boundingRadius=n}update(t){super.update(t);const e=this.game,o=e.worldHeight/2,n=e.totalTime,i=(this.baseY+o)/e.worldHeight;this.temperature=Z(Math.max(0,Math.min(1,i)),this.temperature,{heatZone:h.heatZone,coolZone:h.coolZone,rate:h.heatRate});const a=E(this.temperature,h.neutralTemp,h.buoyancyStrength);this.vy-=a*t;const d=Math.pow(h.damping,t*60);this.vx*=d,this.vy*=d,this.vz*=d,this.baseX+=this.vx*t,this.baseY+=this.vy*t,this.baseZ+=this.vz*t;const m=n+this.timeOffset,r=h.floatRadius*(.7+this.temperature*.6),y=O.float({x:0,y:0},m,15,h.floatSpeed*(.8+this.temperature*.4),h.floatRandomness,r,!0,X.smoothstep),f=n+this.tideOffset,l=O.oscillate(-100,h.tideStrength,f,h.tidePeriod,!0,X.easeInOutSine),p=1-i*.4,g=l.value*p;this.x=this.baseX+y.offsetX+g,this.y=this.baseY+y.offsetY*.3,this.z=this.baseZ+y.offsetY*.5;const u=.5+this.temperature*.5;this.rotX+=this.rotSpeedX*u*t,this.rotY+=this.rotSpeedY*u*t,this.rotZ+=this.rotSpeedZ*u*t,this.reactionCooldown>0&&(this.reactionCooldown-=t),this.flash>0&&(this.flash-=t*2)}render(t,e){if(!this.visible)return;const o=D.ctx,n=this.game.camera,i=Math.cos(this.rotX),a=Math.sin(this.rotX),d=Math.cos(this.rotY),m=Math.sin(this.rotY),r=Math.cos(this.rotZ),y=Math.sin(this.rotZ);for(const l of this.atomData){let p=l.localX,g=l.localY,u=l.localZ,s=g*i-u*a,c=g*a+u*i;g=s,u=c;let b=p*d+u*m;c=-p*m+u*d,p=b,u=c,b=p*r-g*y,s=p*y+g*r,p=b,g=s;const x=this.x+p,S=this.y+g,C=this.z+u,v=n.project(x,S,C);l.screenX=t+v.x,l.screenY=e+v.y,l.screenScale=v.scale,l.worldZ=v.z}const f=[...this.atomData].sort((l,p)=>l.worldZ-p.worldZ);this._renderBonds(o);for(const l of f)this._renderAtom(o,l)}_renderBonds(t){for(const e of this.bonds){const o=this.atomData[e.from],n=this.atomData[e.to];if(o.screenScale<=0||n.screenScale<=0)continue;const i=(o.screenScale+n.screenScale)/2,a=(o.worldZ+n.worldZ)/2,d=Math.max(-10,Math.min(10,a/40)),m=200-this.temperature*180,r=45+d;if(t.strokeStyle=`hsl(${m}, 35%, ${r}%)`,t.lineWidth=3*i,t.lineCap="round",e.order===1)t.beginPath(),t.moveTo(o.screenX,o.screenY),t.lineTo(n.screenX,n.screenY),t.stroke();else if(e.order>=2){const y=n.screenX-o.screenX,f=n.screenY-o.screenY,l=Math.sqrt(y*y+f*f)||1,p=4*i,g=-f/l*p,u=y/l*p;t.lineWidth=2*i;for(let s=0;s<e.order;s++){const c=s-(e.order-1)/2;t.beginPath(),t.moveTo(o.screenX+g*c,o.screenY+u*c),t.lineTo(n.screenX+g*c,n.screenY+u*c),t.stroke()}}}}_renderAtom(t,e){if(e.screenScale<=0)return;const o=e.props,n=o.radius*e.screenScale,i=Math.max(-15,Math.min(10,e.worldZ/30)),a=(this.temperature-.5)*40,d=o.hue+a,m=o.sat+this.temperature*20,r=o.light+i;if(this.flash>0){const f=n*(2+this.flash),l=t.createRadialGradient(e.screenX,e.screenY,0,e.screenX,e.screenY,f);l.addColorStop(0,`rgba(255, 255, 200, ${this.flash*.9})`),l.addColorStop(.4,`rgba(255, 180, 80, ${this.flash*.5})`),l.addColorStop(1,"transparent"),t.fillStyle=l,t.beginPath(),t.arc(e.screenX,e.screenY,f,0,w),t.fill()}const y=t.createRadialGradient(e.screenX-n*.3,e.screenY-n*.3,0,e.screenX,e.screenY,n);y.addColorStop(0,`hsl(${d}, ${m*.3}%, ${Math.min(r+35,95)}%)`),y.addColorStop(.4,`hsl(${d}, ${m}%, ${r}%)`),y.addColorStop(1,`hsl(${d}, ${m+10}%, ${Math.max(r-20,10)}%)`),t.fillStyle=y,t.beginPath(),t.arc(e.screenX,e.screenY,n,0,w),t.fill()}getBounds(){return{x:this.x,y:this.y,width:this.boundingRadius*2,height:this.boundingRadius*2}}}class N extends G{constructor(t){super(t),this.backgroundColor=h.bgColor}init(){super.init(),D.init(this.ctx),this.camera=new L({perspective:h.perspective,rotationX:.2,rotationY:0,inertia:!0,friction:.95,clampX:!1,clampY:!1}),this.camera.enableMouseControl(this.canvas),this.canvas.removeEventListener("dblclick",this.camera._boundHandlers.dblclick),this.molecules=[],this.cx=this.width/2,this.cy=this.height/2,this.reactionLog=[],this.totalTime=0,this.nextLightning=h.lightningInterval,this.stats={reactions:0,maxTier:0},this.worldWidth=this.width*.8,this.worldHeight=this.height*.9,this.bubbles=[];for(let e=0;e<h.bubbleCount;e++)this.bubbles.push(this.createBubble(!0));this.particles=[];for(let e=0;e<h.particleCount;e++)this.particles.push(this.createParticle());for(let e=0;e<h.initialCount;e++)this.spawnMolecule(!0);let t=null;this.canvas.addEventListener("mousedown",e=>{t={x:e.clientX,y:e.clientY}}),this.canvas.addEventListener("mouseup",e=>{if(t){const b=e.clientX-t.x,x=e.clientY-t.y;if(Math.abs(b)>5||Math.abs(x)>5){t=null;return}}t=null;const o=this.canvas.getBoundingClientRect(),n=e.clientX-o.left-this.width/2,i=e.clientY-o.top-this.height/2,a=Math.cos(-this.camera.rotationX),d=Math.sin(-this.camera.rotationX),m=Math.cos(-this.camera.rotationY),r=Math.sin(-this.camera.rotationY);let y=n,f=i,l=(Math.random()-.5)*100;const p=y*m-l*r,g=y*r+l*m;y=p,l=g;const u=f*a-l*d,s=f*d+l*a;f=u,l=s;const c=this.spawnMolecule(!0,y,f,l,void 0,!0);c&&(this.reactionLog.unshift({text:`+ ${c.label} (${c.name})`,time:2}),this.reactionLog.length>5&&this.reactionLog.pop())})}createBubble(t=!1){const e=this.width*.3;return{x:this.width/2+(Math.random()-.5)*e,y:t?Math.random()*this.height:this.height+Math.random()*50,size:2+Math.random()*6,speed:30+Math.random()*50,wobblePhase:Math.random()*w,wobbleSpeed:1+Math.random()*2,alpha:.1+Math.random()*.3}}createParticle(){return{x:Math.random()*this.width,y:Math.random()*this.height,z:(Math.random()-.5)*400,size:1+Math.random()*2,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*5,alpha:.05+Math.random()*.15,hue:Math.random()<.3?30:200}}spawnMolecule(t=!1,e,o,n,i,a=!1){if(!a&&this.molecules.length>=h.maxMolecules)return null;const d=i||(t?P[Math.floor(Math.random()*P.length)]:Object.keys(T)[Math.floor(Math.random()*Object.keys(T).length)]),m=e??(Math.random()-.5)*this.worldWidth,r=o??(Math.random()-.5)*this.worldHeight,y=n??(Math.random()-.5)*200,f=new $(this,d,{x:m,y:r,z:y});return this.molecules.push(f),f}lightning(){const t=(Math.random()-.5)*this.worldWidth,e=(Math.random()-.5)*this.worldHeight*.5,o=(Math.random()-.5)*150;for(const n of this.molecules){const i=n.x-t,a=n.y-e,d=n.z-o,m=Math.sqrt(i*i+a*a+d*d);if(m<h.lightningRadius){const r=1-m/h.lightningRadius;n.temperature=Math.min(1,n.temperature+h.lightningEnergy*r),n.flash=Math.max(n.flash,r*.5)}}this.lightningFlash={x:t,y:e,z:o,intensity:1}}checkReactions(){const t=new Set,e=[];for(let o=0;o<this.molecules.length;o++){const n=this.molecules[o];if(!(n.reactionCooldown>0||t.has(o)))for(let i=o+1;i<this.molecules.length;i++){const a=this.molecules[i];if(a.reactionCooldown>0||t.has(i))continue;const d=a.x-n.x,m=a.y-n.y,r=a.z-n.z;if(Math.sqrt(d*d+m*m+r*r)>h.reactionDistance)continue;const f=(n.temperature+a.temperature)/2;for(const l of j){const[p,g]=l.reactants;if(!(n.templateKey===p&&a.templateKey===g||n.templateKey===g&&a.templateKey===p))continue;const s=h.baseReactionChance*(f/l.minTemp);if(f<l.minTemp*.8||Math.random()>s)continue;t.add(o),t.add(i);const c=(n.x+a.x)/2,b=(n.y+a.y)/2,x=(n.z+a.z)/2;for(const z of l.products){if(!T[z])continue;const H=(Math.random()-.5)*20,M=new $(this,z,{x:c+H,y:b+H,z:x+H});M.temperature=f,M.flash=l.energy,M.reactionCooldown=h.reactionCooldown,M.vx=(n.vx+a.vx)/2+(Math.random()-.5)*15,M.vy=(n.vy+a.vy)/2+(Math.random()-.5)*15,M.vz=(n.vz+a.vz)/2+(Math.random()-.5)*15,e.push(M),this.stats.maxTier=Math.max(this.stats.maxTier,M.tier)}this.stats.reactions++;const S=z=>`${z.label} (${z.name})`,C=[S(n),S(a)].join(" + "),v=l.products.map(z=>{const H=T[z];return H?`${H.label} (${H.name})`:z}).join(" + ");this.reactionLog.unshift({text:`${C} → ${v}`,time:4}),this.reactionLog.length>5&&this.reactionLog.pop();break}}}this.molecules=this.molecules.filter((o,n)=>!t.has(n));for(const o of e)this.molecules.push(o)}applySeparation(t){const e=h.separationPadding,o=h.separationStiffness,n=h.collisionDamping;for(let i=0;i<this.molecules.length;i++){const a=this.molecules[i],d=a.boundingRadius+e;for(let m=i+1;m<this.molecules.length;m++){const r=this.molecules[m],y=r.boundingRadius+e,f=r.x-a.x,l=r.y-a.y,p=r.z-a.z,g=f*f+l*l+p*p,u=d+y;if(g<u*u&&g>.001){const s=Math.sqrt(g),c=u-s,b=f/s,x=l/s,S=p/s,C=c*o*.5;a.baseX-=b*C,a.baseY-=x*C,a.baseZ-=S*C,r.baseX+=b*C,r.baseY+=x*C,r.baseZ+=S*C;const v=a.vx*b+a.vy*x+a.vz*S,z=r.vx*b+r.vy*x+r.vz*S;if(v>z){const M=(v-z)*n;a.vx-=b*M*.5,a.vy-=x*M*.5,a.vz-=S*M*.5,r.vx+=b*M*.5,r.vy+=x*M*.5,r.vz+=S*M*.5}}}}}heatTransfer(){for(let t=0;t<this.molecules.length;t++){const e=this.molecules[t];for(let o=t+1;o<this.molecules.length;o++){const n=this.molecules[o],i=n.x-e.x,a=n.y-e.y,d=n.z-e.z,m=Math.sqrt(i*i+a*a+d*d);if(m<h.heatTransferDist){const r=A(e.temperature,n.temperature,m,h.heatTransferDist,h.heatTransferRate,1);e.temperature=Math.max(0,Math.min(1,e.temperature+r)),n.temperature=Math.max(0,Math.min(1,n.temperature-r))}}}}update(t){super.update(t),this.camera.update(t),this.totalTime+=t,this.nextLightning-=t,this.nextLightning<=0&&(this.lightning(),this.nextLightning=h.lightningInterval+(Math.random()-.5)*h.lightningVariance*2),this.lightningFlash&&(this.lightningFlash.intensity-=t*3,this.lightningFlash.intensity<=0&&(this.lightningFlash=null));for(const e of this.bubbles)e.y-=e.speed*t,e.wobblePhase+=e.wobbleSpeed*t,e.x+=Math.sin(e.wobblePhase)*.5,e.y<-20&&Object.assign(e,this.createBubble(!1));for(const e of this.particles)e.x+=e.vx*t,e.y+=e.vy*t,e.vx+=(Math.sin(this.totalTime*.5+e.y*.01)*2-e.vx*.1)*t,e.vy+=(Math.cos(this.totalTime*.3+e.x*.01)*1-e.vy*.1)*t,e.x<0&&(e.x=this.width),e.x>this.width&&(e.x=0),e.y<0&&(e.y=this.height),e.y>this.height&&(e.y=0);for(const e of this.molecules){e.update(t);const o=50;e.x<-this.worldWidth/2-o&&(e.vx+=50*t),e.x>this.worldWidth/2+o&&(e.vx-=50*t),e.y<-this.worldHeight/2-o&&(e.vy+=50*t),e.y>this.worldHeight/2+o&&(e.vy-=50*t),e.z<-200&&(e.vz+=30*t),e.z>200&&(e.vz-=30*t)}this.applySeparation(t),this.heatTransfer(),this.checkReactions();for(const e of this.reactionLog)e.time-=t;this.reactionLog=this.reactionLog.filter(e=>e.time>0)}render(){const t=this.ctx,e=this.width,o=this.height,n=e/2,i=o/2,a=t.createLinearGradient(0,0,0,o);a.addColorStop(0,"#030612"),a.addColorStop(.5,"#050510"),a.addColorStop(.8,"#0a0508"),a.addColorStop(1,"#1a0505"),t.fillStyle=a,t.fillRect(0,0,e,o),t.globalAlpha=.03;const d=120,m=this.totalTime*h.causticSpeed;for(let s=0;s<5;s++){const c=s*1.3+m,b=e*.3+Math.sin(c)*e*.2,x=o*.2+Math.cos(c*.7)*o*.1,S=e*.7+Math.sin(c*.8+2)*e*.2,C=o*.3+Math.cos(c*.5+1)*o*.1,v=t.createRadialGradient(b,x,0,b,x,d);v.addColorStop(0,"rgba(100, 180, 255, 1)"),v.addColorStop(1,"transparent"),t.fillStyle=v,t.fillRect(0,0,e,o);const z=t.createRadialGradient(S,C,0,S,C,d*.8);z.addColorStop(0,"rgba(150, 200, 255, 1)"),z.addColorStop(1,"transparent"),t.fillStyle=z,t.fillRect(0,0,e,o)}t.globalAlpha=1;const r=t.createRadialGradient(n,o+50,0,n,o+50,o*.7);r.addColorStop(0,`rgba(255, 100, 30, ${h.ventGlow})`),r.addColorStop(.3,`rgba(255, 60, 10, ${h.ventGlow*.5})`),r.addColorStop(.6,`rgba(200, 30, 5, ${h.ventGlow*.2})`),r.addColorStop(1,"transparent"),t.fillStyle=r,t.fillRect(0,0,e,o);const y=t.createRadialGradient(n-e*.2,o+30,0,n-e*.2,o+30,o*.3);y.addColorStop(0,`rgba(255, 80, 20, ${h.ventGlow*.4})`),y.addColorStop(1,"transparent"),t.fillStyle=y,t.fillRect(0,0,e,o);const f=t.createRadialGradient(n+e*.25,o+40,0,n+e*.25,o+40,o*.35);f.addColorStop(0,`rgba(255, 60, 10, ${h.ventGlow*.3})`),f.addColorStop(1,"transparent"),t.fillStyle=f,t.fillRect(0,0,e,o);for(const s of this.particles){const c=.5+(s.z+200)/400*.5;t.fillStyle=`hsla(${s.hue}, 30%, 60%, ${s.alpha*c})`,t.beginPath(),t.arc(s.x,s.y,s.size*c,0,w),t.fill()}if(this.lightningFlash){const s=this.camera.project(this.lightningFlash.x,this.lightningFlash.y,this.lightningFlash.z),c=n+s.x,b=i+s.y,x=t.createRadialGradient(c,b,0,c,b,250);x.addColorStop(0,`rgba(220, 240, 255, ${this.lightningFlash.intensity*.9})`),x.addColorStop(.2,`rgba(180, 210, 255, ${this.lightningFlash.intensity*.5})`),x.addColorStop(.5,`rgba(100, 150, 255, ${this.lightningFlash.intensity*.2})`),x.addColorStop(1,"transparent"),t.fillStyle=x,t.fillRect(0,0,e,o)}const l=[...this.molecules].sort((s,c)=>{const b=this.camera.project(s.x,s.y,s.z),x=this.camera.project(c.x,c.y,c.z);return b.z-x.z});for(const s of l)s.render(n,i);for(const s of this.bubbles){const c=t.createRadialGradient(s.x-s.size*.3,s.y-s.size*.3,0,s.x,s.y,s.size);c.addColorStop(0,`rgba(255, 255, 255, ${s.alpha*.8})`),c.addColorStop(.5,`rgba(200, 220, 255, ${s.alpha*.3})`),c.addColorStop(1,`rgba(150, 180, 220, ${s.alpha*.1})`),t.fillStyle=c,t.beginPath(),t.arc(s.x,s.y,s.size,0,w),t.fill(),t.fillStyle=`rgba(255, 255, 255, ${s.alpha*.6})`,t.beginPath(),t.arc(s.x-s.size*.3,s.y-s.size*.3,s.size*.25,0,w),t.fill()}const p=t.createRadialGradient(n,i,Math.min(e,o)*.3,n,i,Math.max(e,o)*.8);p.addColorStop(0,"transparent"),p.addColorStop(1,"rgba(0, 5, 15, 0.6)"),t.fillStyle=p,t.fillRect(0,0,e,o),t.font='11px "Fira Code", monospace',t.textAlign="left";let g=25;for(const s of this.reactionLog){const c=Math.min(1,s.time);t.fillStyle=`rgba(255, 200, 100, ${c*.9})`,t.fillText(s.text,15,g),g+=18}t.fillStyle="rgba(150, 180, 200, 0.6)",t.textAlign="right",t.fillText(`Molecules: ${this.molecules.length}`,e-15,25),t.fillText(`Reactions: ${this.stats.reactions}`,e-15,43);const u=["Primordial","Precursors","Amino Acids","Peptides"];t.fillText(`Max tier: ${u[this.stats.maxTier]||"???"}`,e-15,61),t.textAlign="center",t.fillStyle="rgba(150, 150, 150, 0.4)",t.fillText("Click to add molecules. Drag to orbit. Watch complexity emerge.",n,o-15)}}function _(Y){const t=new N(Y);return t.start(),{stop:()=>t.stop(),game:t}}export{_ as default};
